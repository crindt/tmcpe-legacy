
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S4/
	M1	Time Steps	/0*56/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S4	0.243000
		S3	0.145000
		S2	0.230000
		S1	0.405000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40    41    42    43    44    45    46    47    48    49    50    51    52    53    54    55    56
   S4   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S3   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S2   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S1   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S0   1.0   0.0   1.0   0.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   0.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40    41    42    43    44    45    46    47    48    49    50    51    52    53    54    55    56
   S4  71.5  71.3  71.6  72.0  73.0  72.7  71.5  72.1  72.2  71.9  72.5  73.1  72.5  71.7  72.3  71.5  70.9  70.8  71.4  71.3  71.0  71.8  71.8  70.6  70.6  70.5  71.6  72.1  70.7  70.4  69.9  70.7  70.9  71.4  71.4  70.9  71.0  70.2  70.4  69.4  70.9  71.1  70.2  70.8  71.2  72.0  70.1  68.9  70.1  70.2  69.7  69.8  69.6  70.3  70.4  69.3  69.6
   S3  74.1  73.4  73.4  73.9  74.3  74.6  72.9  73.5  73.8  73.7  74.8  75.3  75.2  73.5  74.5  73.7  72.3  72.5  73.2  73.2  73.3  74.8  74.1  74.0  73.9  73.5  75.0  75.1  74.7  74.1  72.9  72.8  73.8  74.5  74.0  73.0  74.0  73.6  74.1  73.0  74.1  73.9  74.2  73.3  73.3  74.7  73.6  72.0  72.8  73.2  74.1  73.1  74.1  74.6  74.0  72.1  72.9
   S2  73.0  72.3  72.2  72.6  72.1  72.8  70.6  71.0  70.9  71.1  71.2  72.3  72.2  72.2  72.0  72.1  71.5  71.0  71.6  71.2  72.0  71.4  71.8  71.7  70.9  70.9  72.3  71.9  71.9  71.0  70.5  70.9  71.3  71.7  71.0  71.2  71.7  70.8  70.8  72.2  72.0  71.7  71.5  71.0  71.7  72.0  71.2  70.5  70.6  71.6  72.1  71.3  71.1  71.5  71.6  70.6  71.1
   S1  74.8  74.3  73.9  74.0  74.8  75.3  73.4  74.6  72.8  73.1  73.8  73.6  74.0  72.9  75.1  72.7  73.1  71.0  72.6  73.6  73.8  72.1  72.9  73.8  73.6  71.8  73.6  74.7  74.5  73.3  73.6  71.9  72.9  73.8  73.3  73.3  73.8  72.9  74.5  74.3  74.0  73.6  74.0  73.4  74.2  73.9  74.2  71.0  71.7  72.7  73.5  73.5  73.6  72.9  72.9  72.3  73.1
   S0  71.1  69.0  70.1  68.9  69.3  69.6  67.0  69.2  69.3  68.7  68.7  69.2  69.0  67.6  70.4  70.3  69.9  69.8  70.1  66.0  68.6  67.3  69.3  69.4  67.6  66.9  68.4  70.0  70.5  67.7  67.2  65.7  67.7  72.3  76.5  78.3  78.8  77.9  77.9  77.8  78.1  77.8  76.6  75.8  76.9  75.0  76.6  76.3  76.5  77.4  76.6  77.0  76.9  76.7  76.6  76.2  77.5
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40    41    42    43    44    45    46    47    48    49    50    51    52    53    54    55    56
   S4  72.4  71.6  71.6  71.5  71.6  71.6  71.8  71.5  71.2  71.2  71.2  70.9  70.4  70.2  70.0  69.7  69.7  69.0  69.0  69.2  69.3  69.1  69.1  69.7  69.4  69.4  69.5  69.6  69.7  69.5  69.3  69.0  68.8  69.3  69.5  70.0  69.7  69.2  69.5  69.6  69.5  69.8  69.3  69.7  69.6  70.0  69.8  69.9  70.0  69.9  69.8  69.5  69.3  69.3  69.0  69.0  68.7
   S3  74.3  74.1  73.7  73.5  73.7  73.7  73.3  73.3  73.0  73.4  73.4  73.7  73.2  72.5  72.3  72.1  71.9  71.6  71.6  71.6  71.8  71.8  72.0  72.5  72.2  72.0  72.2  72.2  72.3  72.5  72.4  72.3  72.3  72.4  72.4  72.7  72.6  72.4  72.5  72.6  72.6  72.4  72.3  72.5  72.4  72.5  72.6  73.0  73.0  72.8  72.8  72.6  72.5  72.4  72.5  72.4  72.6
   S2  73.0  72.9  72.7  72.9  72.7  72.7  72.4  72.2  71.8  72.0  72.0  72.2  72.0  71.6  71.4  71.4  71.5  71.2  71.1  71.3  71.4  71.3  71.5  71.7  71.5  71.4  71.5  71.4  71.2  71.3  71.3  71.3  71.3  71.4  71.4  71.9  71.8  71.6  71.5  71.6  71.6  71.5  71.4  71.5  71.5  71.6  71.6  72.0  71.8  71.6  71.6  71.6  71.6  71.4  71.5  71.4  71.6
   S1  74.3  74.1  74.0  74.5  74.9  74.9  74.5  74.6  74.4  74.4  74.6  74.9  74.5  74.1  73.8  73.7  73.7  73.5  73.5  73.4  73.4  73.4  73.5  73.9  73.4  73.3  73.2  73.2  73.3  73.6  73.6  73.5  73.5  73.7  73.7  74.0  73.3  72.8  72.5  72.4  72.5  72.6  73.1  73.0  73.3  73.2  73.4  73.3  73.3  73.3  73.3  73.2  73.2  73.1  73.3  73.1  73.2
   S0  73.2  73.0  72.7  72.2  71.8  72.0  71.5  71.6  71.7  71.6  71.6  72.1  71.5  71.2  70.9  71.0  70.7  70.7  70.6  70.5  70.6  70.7  70.6  71.1  70.9  70.5  70.5  70.4  70.0  70.4  70.4  70.7  70.7  71.0  70.6  70.7  70.5  70.5  70.1  70.1  69.9  69.8  70.3  70.6  71.3  71.6  71.5  71.6  71.4  71.1  71.0  71.0  71.3  71.0  71.1  71.1  71.0
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40    41    42    43    44    45    46    47    48    49    50    51    52    53    54    55    56
   S4   272   292   306   267   269   244   298   290   265   343   288   309   283   300   309   315   358   295   324   318   324   297   299   318   325   328   353   307   336   364   354   379   398   344   359   293   350   348   370   407   333   379   362   362   333   309   348   334   376   365   404   378   336   347   354   362   384
   S3   280   300   315   291   268   256   309   306   286   360   321   318   322   320   331   332   379   330   347   340   347   306   310   336   360   324   391   313   352   379   381   379   408   366   373   314   386   376   388   418   354   386   370   371   333   320   356   361   371   372   419   380   365   377   375   380   401
   S2   312   300   310   291   271   256   308   295   308   364   346   318   327   319   331   356   381   345   358   350   354   326   328   339   366   327   384   345   369   396   395   395   411   381   386   315   401   380   420   436   372   383   390   368   341   348   377   368   399   409   406   406   370   370   402   376   409
   S1   264   314   313   313   266   257   307   305   333   353   352   336   345   311   354   352   381   322   356   353   351   338   329   342   362   342   403   334   341   408   385   403   412   385   376   337   406   386   419   448   370   388   387   387   346   350   359   385   360   404   428   404   384   376   415   357   433
   S0   351   379   381   371   360   332   376   373   401   418   421   390   419   373   403   437   453   392   433   441   434   412   387   400   450   424   463   432   411   493   451   439   424   455   429   425   472   453   497   553   445   420   436   431   381   385   399   423   407   448   491   453   454   408   497   416   483
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40    41    42    43    44    45    46    47    48    49    50    51    52    53    54    55    56
   S4   281   285   291   300   296   300   308   314   314   319   319   316   310   318   315   324   325   334   341   342   353   354   345   358   358   358   357   364   365   367   366   366   365   357   358   356   355   362   365   366   363   362   361   353   355   350   352   357   350   352   364   364   358   368   367   364   369
   S3   281   290   298   306   306   311   321   328   332   335   335   335   325   333   331   339   348   349   359   359   364   372   363   376   381   378   379   381   383   384   384   381   384   374   380   376   371   377   384   385   380   377   379   375   374   370   372   379   371   373   382   382   377   383   383   379   384
   S2   297   298   307   314   314   320   335   341   351   350   351   350   338   343   344   347   356   357   369   369   376   385   378   390   391   392   402   399   404   401   402   398   396   388   390   389   384   388   392   393   388   388   386   379   382   379   381   387   381   384   393   395   386   391   396   396   396
   S1   293   293   304   307   312   319   334   341   352   351   351   350   339   339   343   346   353   353   362   360   364   376   365   379   378   382   393   389   397   401   400   399   399   394   396   396   389   391   398   405   398   399   399   394   392   390   391   395   392   397   405   404   401   404   407   406   410
   S0   333   329   343   343   351   355   369   386   389   397   393   391   379   382   385   386   396   389   400   404   406   415   407   420   416   422   434   435   437   444   441   440   439   438   434   433   431   431   438   451   441   440   441   431   430   427   426   438   427   435   450   444   438   439   444   445   450

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

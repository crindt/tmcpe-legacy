
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S4/
	M1	Time Steps	/0*37/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S4	0.350000
		S3	0.255000
		S2	0.320000
		S1	0.410000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S4   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S3   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S2   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S1   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S3  66.2  65.9  66.0  64.8  64.7  64.3  63.8  65.0  63.6  63.6  63.7  65.0  64.0  67.6  70.4  72.6  73.8  74.1  74.1  72.9  71.5  70.6  69.5  71.3  73.9  72.3  73.7  74.2  72.9  71.2  70.3  69.8  70.5  70.0  70.2  73.0  72.6  70.2
   S2  66.7  65.5  66.6  64.7  65.4  64.9  64.1  65.1  64.5  65.0  64.4  64.2  63.5  67.3  68.2  68.9  68.6  69.1  69.2  68.3  67.4  66.7  66.4  68.8  69.8  69.5  70.0  71.0  70.8  70.8  71.0  70.9  71.1  71.0  70.4  73.0  72.3  71.1
   S1  25.6  25.1  25.6  27.6  25.2  26.0  25.3  24.7  24.7  28.3  22.9  26.7  25.5  27.1  27.8  26.4  28.4  31.1  29.3  27.6  28.1  27.0  27.2  26.5  27.9  28.9  26.0  28.1  28.2  28.5  26.7  26.5  25.1  28.8  32.2  28.1  30.3  28.5
   S0  46.3  46.4  46.9  47.2  47.1  47.0  47.2  47.6  47.4  46.8  45.9  46.8  46.6  47.2  46.6  46.9  47.3  47.6  47.2  46.8  46.3  46.0  46.7  47.1  46.3  46.0  45.8  46.8  47.0  48.1  48.4  47.9  48.1  47.4  46.9  47.5  47.8  47.9
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S3  68.9  68.6  68.2  68.3  68.8  68.6  69.0  68.9  68.9  68.5  68.6  68.5  68.7  68.9  69.2  69.2  69.5  69.2  69.8  70.3  70.9  70.3  70.2  70.1  70.5  70.1  70.1  70.4  70.5  70.3  70.5  70.8  71.7  71.2  71.4  71.5  71.6  71.7
   S2  64.1  64.0  63.8  63.7  64.1  63.7  64.1  64.3  65.3  64.4  64.4  64.2  64.5  64.7  64.8  65.0  65.2  64.8  65.4  65.8  66.9  66.5  66.4  66.3  66.9  66.6  66.5  66.9  67.1  67.2  67.4  67.6  68.8  68.1  68.4  68.5  68.7  69.0
   S1  60.3  60.4  60.1  60.1  60.7  60.4  60.0  60.4  60.7  60.5  60.0  60.1  60.2  59.5  60.1  60.7  60.2  60.6  60.3  60.1  60.6  60.3  60.5  60.4  59.9  59.9  60.6  60.5  59.8  60.0  59.7  59.4  59.6  61.0  61.1  59.2  57.6  56.8
   S0  62.5  62.1  62.1  62.1  62.3  62.3  62.4  62.5  63.0  62.7  62.6  62.7  62.7  62.7  62.9  63.2  62.6  62.5  62.8  63.2  64.0  63.7  63.8  63.5  63.7  64.0  63.8  64.3  64.4  63.1  62.8  63.0  63.9  64.0  63.2  62.8  62.7  62.7
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S4     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S3   393   307   328   370   368   346   362   376   343   342   326   335   425   373   378   421   474   456   521   435   413   448   442   436   393   381   429   468   461   500   441   427   381   394   476   468   446   425
   S2   373   290   323   348   364   333   329   340   334   330   312   317   398   362   361   413   433   428   473   414   384   417   411   411   365   360   402   432   421   473   418   407   371   371   425   446   415   377
   S1   521   511   502   556   595   649   631   582   436   447   506   502   604   527   425   610   614   546   593   567   390   496   583   664   535   496   436   610   586   808   714   685   658   523   568   718   591   608
   S0   416   401   333   369   386   398   434   411   282   338   319   346   428   347   331   359   431   414   409   391   308   366   494   492   354   319   346   401   412   562   492   502   459   354   383   499   492   475
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S4     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S3   379   375   378   378   397   399   387   372   376   374   404   394   410   394   398   433   471   469   464   430   422   420   457   427   433   395   399   454   485   479   445   406   418   426   450   453   447   399
   S2   362   359   364   362   380   379   369   356   365   360   385   378   387   377   379   408   440   437   430   409   399   401   426   406   403   378   376   426   454   452   418   387   392   401   417   426   414   379
   S1   462   461   467   473   493   490   488   461   459   466   499   490   491   501   466   512   555   556   542   519   486   509   532   540   511   496   470   542   584   595   540   520   503   539   547   561   537   508
   S0   466   474   468   479   498   502   497   464   475   472   505   498   485   507   483   523   564   574   561   533   501   528   547   540   522   511   487   543   596   590   562   511   507   534   564   566   557   520

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

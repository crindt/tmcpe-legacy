
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S15/
	M1	Time Steps	/0*31/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S15	0.355000
		S14	0.380000
		S13	0.535000
		S12	0.475000
		S11	0.500000
		S10	0.480000
		S9	0.335000
		S8	0.365000
		S7	0.440000
		S6	0.420000
		S5	0.485000
		S4	1.060000
		S3	0.979000
		S2	0.856000
		S1	0.870000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
  S15   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S14   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S13   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S12   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S11   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S10   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S9   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S8   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S7   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S6   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S5   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S4   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S3   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S2   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S1   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
  S15  67.6  66.3  63.4  68.0  68.7  69.4  68.4  69.2  68.8  68.3  67.0  66.0  65.8  66.5  65.3  63.5  63.3  61.9  62.7  63.3  64.7  64.1  64.2  64.8  65.7  66.5  66.4  66.4  67.0  66.7  67.0  67.9
  S14  63.4  61.6  62.3  65.3  66.2  67.9  67.5  69.3  65.7  64.9  63.3  63.4  62.7  63.6  62.0  59.2  58.2  57.4  56.5  57.4  59.3  59.6  59.9  60.9  62.7  63.1  63.4  62.9  64.3  64.9  64.0  64.0
  S13  67.6  65.3  65.8  68.0  70.0  69.5  67.2  69.4  65.1  64.1  62.8  62.0  61.2  61.7  59.4  58.3  57.2  56.7  55.8  56.2  58.6  60.3  61.1  63.1  65.7  67.1  67.8  67.1  67.7  68.5  67.8  68.0
  S12  59.6  54.8  40.6  29.9  22.1  18.1  15.9  14.0  14.9  14.6  16.5  17.3  17.7  15.6  19.8  28.4  30.8  32.4  34.9  34.7  35.1  36.9  38.1  41.9  53.4  57.1  59.7  58.1  59.5  60.3  61.7  58.9
  S11  59.2  59.0  37.9  28.6  20.9  16.6  14.1  14.4  13.3  14.8  14.1  14.6  16.5  14.3  16.5  21.5  22.3  26.1  29.6  28.8  28.8  31.8  30.4  40.8  53.0  56.7  58.8  58.5  59.6  60.8  61.3  61.0
  S10  62.9  62.0  59.0  42.0  32.6  25.4  19.8  21.1  20.3  18.8  20.7  19.7  22.2  23.5  20.0  24.6  35.6  38.0  47.4  49.0  39.3  44.6  55.9  60.0  62.7  63.6  63.7  63.1  62.9  63.9  64.9  64.0
   S9  62.4  61.3  58.0  35.1  25.4  18.1  13.5  13.5  14.0  12.5  14.9  14.1  14.9  15.2  13.5  16.4  22.3  27.5  35.6  33.5  29.9  38.1  53.8  59.5  61.0  62.6  62.4  62.3  62.3  61.7  63.1  63.3
   S8  60.3  61.8  60.7  46.5  29.4  19.9  14.1  12.7  16.4  14.5  13.8  14.0  13.5  13.0  12.0  17.2  20.8  31.5  31.2  42.5  38.8  51.5  58.1  60.4  59.9  61.7  61.5  60.5  61.2  61.7  62.6  62.6
   S7  61.2  60.8  60.3  60.1  38.3  28.4  19.7  16.1  20.1  16.8  15.8  16.6  15.7  17.1  15.8  16.3  20.1  28.6  29.4  41.5  49.2  55.2  59.4  60.8  61.1  61.9  60.4  60.8  61.0  59.1  60.9  60.2
   S6  63.4  62.8  63.4  63.3  49.0  31.0  21.3  15.3  13.9  13.9  12.4  13.1  13.5  12.5  11.9  12.2  13.7  20.2  21.6  25.4  44.8  52.9  58.7  60.2  60.9  61.6  59.7  61.5  62.5  60.5  63.4  62.2
   S5  59.1  58.8  60.2  60.7  55.5  34.8  23.8  17.5  14.6  15.6  13.1  12.0  12.0  11.4  11.3  11.2  13.8  17.7  20.3  23.2  42.2  50.2  54.7  56.5  57.7  58.9  58.0  58.7  58.5  57.5  60.0  59.3
   S4  70.0  71.0  71.0  70.2  70.6  70.2  69.8  73.4  70.6  69.3  68.2  68.6  67.8  69.0  68.0  68.0  68.4  69.0  69.0  69.9  69.7  69.2  70.0  70.2  70.4  69.8  69.3  69.4  69.3  69.0  70.4  69.5
   S3  64.0  62.9  62.7  64.5  62.4  61.5  62.2  66.9  62.4  55.8  42.4  29.6  21.0  19.7  22.8  24.8  34.9  44.3  55.7  61.4  60.6  63.4  62.2  62.4  62.5  63.3  62.6  63.9  64.0  63.9  63.9  62.0
   S2   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S1   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
  S15  58.8  58.8  58.4  58.6  58.6  59.0  58.9  59.5  58.8  58.8  58.7  58.7  59.1  59.3  59.4  59.8  59.8  60.0  60.2  61.1  61.0  61.0  61.0  60.9  60.6  60.9  60.9  61.0  61.1  61.1  61.5  61.9
  S14  53.2  53.3  53.1  53.4  53.2  53.4  53.1  53.4  53.1  53.3  53.3  53.7  53.8  54.2  54.8  55.4  55.8  56.0  56.7  57.8  58.4  58.2  58.7  58.7  58.7  58.9  58.6  58.5  58.6  58.7  59.0  59.4
  S13  59.0  59.3  59.5  60.3  60.4  60.4  60.3  60.8  60.1  59.6  59.1  59.3  59.7  60.3  60.7  61.1  61.6  62.2  62.7  63.8  64.0  63.9  63.6  63.5  63.3  63.9  64.1  64.0  64.1  64.4  64.3  64.3
  S12  51.1  50.9  51.7  51.0  51.5  52.5  52.3  53.2  52.1  51.8  51.7  51.8  52.6  52.8  54.0  54.9  54.7  54.6  55.1  56.7  56.6  55.3  54.8  55.3  56.3  56.7  57.2  56.8  57.1  56.4  55.2  54.0
  S11  52.8  53.6  53.9  53.7  54.5  54.4  54.7  55.5  54.3  54.4  54.7  54.7  55.8  55.8  56.8  57.4  57.1  56.8  57.7  58.8  58.7  58.2  57.8  58.1  58.6  58.9  59.7  60.0  60.4  59.7  59.1  59.0
  S10  55.9  57.4  57.4  56.8  57.0  57.2  57.4  57.8  57.6  57.0  57.6  57.8  57.6  57.7  57.3  57.7  57.6  57.5  57.7  58.3  58.0  58.3  59.0  59.2  59.1  59.1  58.8  59.1  58.7  59.1  58.7  59.1
   S9  55.1  56.9  57.0  57.0  57.0  57.2  57.8  57.5  57.7  57.1  57.5  58.4  58.3  58.3  57.9  57.9  57.8  58.0  58.4  59.0  58.7  59.1  59.7  60.0  59.9  60.1  59.8  59.9  59.8  59.7  59.6  59.8
   S8  54.6  54.8  55.2  55.3  54.9  55.3  55.4  56.1  56.2  56.1  56.5  56.6  56.7  57.0  56.7  56.5  56.6  56.8  56.6  57.9  58.4  59.1  59.3  59.6  59.9  60.2  59.7  59.7  59.2  59.4  59.4  59.6
   S7  55.8  56.0  57.3  57.2  57.2  56.7  56.8  57.8  57.7  57.4  57.8  57.9  58.5  58.7  58.6  58.4  58.1  58.4  58.9  59.5  59.1  59.2  59.9  59.9  60.1  60.0  60.0  60.4  60.3  60.3  60.1  60.1
   S6  53.2  53.1  54.1  54.6  54.9  54.0  54.4  54.3  54.8  54.5  54.9  55.3  55.9  55.9  56.9  56.7  56.6  56.7  57.4  57.8  57.5  57.9  58.6  58.7  59.2  59.1  59.4  59.1  59.6  58.9  58.7  58.5
   S5  55.3  55.3  55.3  55.3  55.1  53.7  53.7  53.6  53.3  52.7  52.4  52.9  52.7  53.0  53.5  53.8  53.4  54.4  54.8  56.0  56.5  56.8  57.6  58.4  58.7  58.8  58.7  58.6  58.9  58.7  58.5  57.8
   S4  67.7  67.7  67.9  67.7  67.8  67.5  67.6  68.4  68.0  67.8  67.8  68.0  68.4  68.3  68.5  68.5  68.6  68.5  68.6  69.0  69.1  69.4  69.5  69.6  69.5  69.5  69.3  69.5  69.5  69.3  69.5  69.8
   S3  60.2  60.0  60.7  60.5  60.3  60.4  60.8  61.7  61.4  61.2  61.2  60.8  60.8  61.1  61.1  61.4  61.7  62.0  62.7  63.1  62.8  62.7  62.9  63.0  62.9  62.9  62.7  62.6  62.4  61.9  61.9  62.3
   S2   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S1   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
  S15   355   336   105   123   133    87   322   319   324   338   306   338   318   318   352   404   404   412   385   404   393   410   374   364   383   353   346   336   365   409   369   398
  S14   564   521   161   186   215   162   471   523   488   503   497   483   497   495   518   619   603   606   624   636   609   656   629   591   607   570   556   568   578   655   595   627
  S13   538   462   124   154   163   149   423   455   423   434   433   438   431   439   488   555   555   565   581   588   568   594   573   544   553   526   509   532   532   585   551   595
  S12   535   542   132   116   118    77   340   368   367   374   376   371   367   367   425   522   564   564   584   577   579   580   586   535   547   487   516   544   534   591   566   572
  S11   509   514   222   104   115    65   250   341   312   350   338   302   326   300   383   452   500   509   511   490   481   485   526   460   497   434   466   479   441   507   472   496
  S10   526   527   522   308   155   191   142   383   363   350   352   325   376   349   336   429   504   513   557   532   510   482   496   475   507   498   466   510   488   485   476   497
   S9   470   473   499   323   155   176   137   322   350   313   349   321   341   340   313   398   466   484   525   509   489   441   447   442   477   459   429   475   458   457   439   460
   S8   519   494   524   483   248   238   220   340   453   361   384   359   361   358   335   447   485   547   515   562   506   463   475   485   535   504   467   507   492   466   463   499
   S7   540   506   525   525   410   251   291   232   484   377   382   379   379   419   338   435   445   522   527   580   490   469   477   508   519   516   476   514   506   477   485   489
   S6   483   471   442   453   472   248   232   200   309   350   280   326   322   308   330   294   364   451   478   479   399   398   411   432   456   441   422   450   418   412   420   405
   S5   457   427   423   414   450   277   207   225   253   329   277   291   297   280   300   265   347   411   447   414   369   369   376   394   434   408   384   415   379   380   383   367
   S4   443   420   396   417   449   442   420   458   398   475   416   397   419   472   394   406   433   496   452   387   373   373   372   415   417   385   396   448   469   410   350   406
   S3   472   462   488   461   485   475   432   453   493   395   404   371   365   407   475   456   444   444   425   381   425   406   423   489   417   432   444   427   447   431   400   407
   S2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
  S15   351   347   345   349   341   337   344   349   344   346   340   344   346   344   352   346   346   341   341   348   341   344   344   344   342   342   340   350   347   345   345   350
  S14   600   603   597   601   596   584   595   606   592   604   602   604   610   610   610   607   607   600   605   611   605   610   610   609   599   604   603   611   610   611   620   628
  S13   564   564   555   559   555   546   555   564   552   566   560   560   565   571   563   562   565   558   558   570   561   566   564   564   554   562   557   568   565   569   577   584
  S12   578   579   575   569   559   561   567   580   569   577   570   576   581   583   573   572   576   565   576   574   570   572   570   571   562   569   565   577   578   578   581   583
  S11   519   520   522   515   511   504   500   504   502   515   506   509   512   507   505   509   509   498   501   491   493   496   505   502   500   505   503   508   509   502   504   501
  S10   521   527   526   521   510   506   505   505   509   509   513   508   517   513   506   520   516   504   500   501   492   503   512   512   513   514   514   518   515   503   506   502
   S9   488   496   498   489   480   479   475   473   475   474   482   478   486   480   475   487   483   477   472   471   466   472   477   482   485   482   483   485   483   470   469   468
   S8   522   527   531   525   512   516   507   514   507   512   514   507   517   511   510   525   512   511   507   501   502   509   514   520   525   525   523   529   520   507   506   506
   S7   539   538   548   533   532   524   521   520   524   529   525   523   530   529   529   540   525   528   517   509   511   524   523   534   535   541   536   540   535   526   512   521
   S6   464   473   472   462   457   457   442   445   450   447   444   451   446   450   445   455   443   446   432   434   435   442   437   452   447   459   447   454   438   442   426   438
   S5   424   432   439   425   428   422   403   408   412   405   410   404   417   404   414   415   402   398   397   403   396   399   401   408   405   417   396   405   394   389   385   385
   S4   446   443   449   441   440   440   434   431   434   411   416   422   422   420   413   427   410   413   408   397   405   414   407   414   421   417   411   412   406   406   400   397
   S3   471   466   474   475   476   472   458   459   462   449   450   451   463   458   455   468   460   458   450   439   437   439   443   453   457   452   453   450   450   442   439   426
   S2     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S1     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

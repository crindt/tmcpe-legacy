
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S5/
	M1	Time Steps	/0*36/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S5	0.243000
		S4	0.145000
		S3	0.230000
		S2	0.405000
		S1	0.410000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
   S5   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   1.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S3   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S2   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S1   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
   S5  71.0  68.1  66.3  67.1  63.8  64.0  63.5  67.0  68.0  66.5  67.8  65.1  66.6  68.4  69.1  70.2  68.0  68.8  70.2  66.3  67.6  68.0  65.9  72.8  69.1  63.9  62.0  62.0  63.5  66.8  67.5  68.7  68.6  69.2  69.2  69.5  69.6
   S4  71.5  72.3  71.2  71.5  70.6  69.8  69.6  68.7  68.2  69.6  69.2  69.3  69.6  69.7  69.0  69.3  68.2  68.0  68.8  70.8  70.7  69.6  71.1  71.2  69.9  69.0  69.3  70.0  71.1  71.3  71.2  71.2  70.6  71.9  72.6  71.6  70.7
   S3  68.7  68.1  68.0  68.0  66.2  66.7  66.8  66.9  67.8  68.5  66.9  67.4  67.0  68.0  67.4  68.3  67.1  67.6  67.7  68.4  68.3  67.9  67.9  68.1  67.4  66.2  67.0  66.8  66.9  68.2  67.6  67.7  67.2  67.5  67.5  67.0  66.5
   S2  73.5  73.8  74.1  58.7  55.5  42.1  29.5  20.8  15.1  11.8  10.3   8.7  13.2  40.7  54.8  62.3  66.4  69.0  70.0  71.3  72.1  72.7  72.9  73.0  72.6  72.4  72.1  72.4  73.2  72.1  71.3  71.7  72.1  72.3  71.7  71.7  71.2
   S1  74.5  73.3  71.2  69.0  63.3  60.7  62.1  61.4  61.7  61.5  61.4  61.9  60.7  65.3  67.6  68.6  68.5  68.0  68.8  68.4  69.1  71.4  72.5  72.7  72.8  71.4  71.5  71.1  72.8  72.4  71.8  73.2  73.1  73.2  72.1  72.4  70.4
   S0  69.2  69.2  69.3  68.8  66.3  65.2  66.1  66.8  66.2  65.9  66.0  66.0  65.7  67.1  67.4  67.6  67.1  66.6  66.7  68.1  69.6  69.8  69.8  69.9  69.6  69.2  68.4  68.3  69.7  68.9  68.3  69.1  69.5  69.7  69.0  68.3  68.0
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
   S5  71.0  70.9  70.9  71.0  70.7  70.7  71.5  71.5  71.6  72.0  72.4  71.6  71.6  71.5  71.6  71.6  71.8  71.5  71.2  71.2  71.2  70.9  70.4  70.2  70.0  69.7  69.7  69.0  69.0  69.2  69.3  69.1  69.1  69.7  69.4  69.4  69.5
   S4  74.2  74.0  73.9  73.8  73.9  73.8  74.0  74.0  73.9  74.8  74.3  74.1  73.7  73.5  73.7  73.7  73.3  73.3  73.0  73.4  73.4  73.7  73.2  72.5  72.3  72.1  71.9  71.6  71.6  71.6  71.8  71.8  72.0  72.5  72.2  72.0  72.2
   S3  72.5  72.4  72.4  72.5  72.4  72.3  72.5  72.6  72.7  73.4  73.0  72.9  72.7  72.9  72.7  72.7  72.4  72.2  71.8  72.0  72.0  72.2  72.0  71.6  71.4  71.4  71.5  71.2  71.1  71.3  71.4  71.3  71.5  71.7  71.5  71.4  71.5
   S2  75.5  75.4  75.3  74.7  74.9  74.4  74.4  74.1  74.1  74.6  74.3  74.1  74.0  74.5  74.9  74.9  74.5  74.6  74.4  74.4  74.6  74.9  74.5  74.1  73.8  73.7  73.7  73.5  73.5  73.4  73.4  73.4  73.5  73.9  73.4  73.3  73.2
   S1  74.0  73.7  73.4  72.9  72.7  72.0  72.1  72.8  72.8  73.5  73.2  73.0  72.7  72.2  71.8  72.0  71.5  71.6  71.7  71.6  71.6  72.1  71.5  71.2  70.9  71.0  70.7  70.7  70.6  70.5  70.6  70.7  70.6  71.1  70.9  70.5  70.5
   S0  72.7  72.6  72.6  72.4  72.6  72.4  72.5  72.7  72.6  73.1  72.7  72.7  72.3  72.2  72.2  72.2  71.9  71.8  71.8  71.4  71.7  72.3  72.0  71.4  71.3  71.2  71.3  71.4  71.3  71.4  71.2  71.3  71.3  71.5  71.4  71.1  70.3
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
   S5   215   228   228   248   266   244   298   270   299   282   266   248   260   313   282   280   283   326   322   301   304   305   292   231   268   280   320   299   304   337   349   343   304   295   358   389   313
   S4   215   223   214   246   288   279   293   271   307   322   273   266   269   338   298   315   317   345   350   352   334   352   313   314   347   335   379   340   333   366   381   369   321   331   384   408   338
   S3   219   232   218   254   281   308   298   283   312   323   262   277   281   327   299   327   351   352   370   354   350   347   326   334   356   319   384   333   359   369   379   384   314   340   410   426   355
   S2   237   246   238   243   295   273   258   228   248   204   280   248   323   327   332   334   347   348   379   367   383   363   361   335   371   354   423   359   350   397   380   405   346   370   388   440   381
   S1   249   262   285   225   353   246   291   241   299   265   323   247   502   348   351   348   358   396   387   386   407   393   380   363   378   383   426   391   356   449   398   438   376   413   407   469   430
   S0   225   229   253   190   316   222   253   220   255   221   283   231   466   309   306   319   323   359   347   338   356   359   327   327   312   346   378   333   317   375   384   391   335   354   368   409   386
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
   S5   233   247   248   259   272   285   286   294   291   287   281   285   291   300   296   300   308   314   314   319   319   316   310   318   315   324   325   334   341   342   353   354   345   358   358   358   357
   S4   230   244   250   265   276   294   293   296   294   287   281   290   298   306   306   311   321   328   332   335   335   335   325   333   331   339   348   349   359   359   364   372   363   376   381   378   379
   S3   237   254   257   269   285   301   303   308   306   301   297   298   307   314   314   320   335   341   351   350   351   350   338   343   344   347   356   357   369   369   376   385   378   390   391   392   402
   S2   237   252   254   266   283   292   301   303   301   291   293   293   304   307   312   319   334   341   352   351   351   350   339   339   343   346   353   353   362   360   364   376   365   379   378   382   393
   S1   268   284   286   298   315   327   341   346   340   330   333   329   343   343   351   355   369   386   389   397   393   391   379   382   385   386   396   389   400   404   406   415   407   420   416   422   434
   S0   222   232   237   249   265   275   284   280   275   275   272   275   289   289   292   298   310   327   325   332   329   332   319   326   324   324   331   329   334   336   339   345   343   350   347   359   368

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;


$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S9/
	M1	Time Steps	/0*37/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S9	0.790000
		S8	0.405000
		S7	0.275000
		S6	0.445000
		S5	0.425000
		S4	0.410000
		S3	0.600000
		S2	0.490000
		S1	0.455000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S9   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   0.0   1.0
   S8   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S7   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S6   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S4   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S3   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S2   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S1   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S9  67.5  68.1  68.3  68.1  68.1  67.8  67.9  67.8  67.7  67.8  68.0  67.8  68.0  68.4  68.2  67.0  67.2  67.5  66.9  66.9  67.0  67.4  66.9  67.9  67.6  67.7  67.6  68.0  67.5  67.6  68.0  67.6  67.4  67.9  67.7  67.7  67.4  67.9
   S8  15.4  12.1   9.8  14.2  25.6  38.0  45.8  51.0  55.0  55.9  55.4  56.6  55.3  53.5  51.4  51.5  54.4  52.8  56.1  55.5  55.1  54.8  54.9  54.7  55.0  54.7  55.8  55.1  54.6  54.3  55.3  54.7  56.3  57.3  56.2  57.0  54.3  52.9
   S7  27.0  26.9  32.7  50.2  56.6  61.0  63.2  63.3  65.1  64.3  65.3  64.4  63.5  59.6  56.8  58.0  62.5  62.7  66.9  66.2  63.7  62.7  63.5  63.6  64.8  65.0  64.0  63.9  63.2  63.8  65.1  64.4  65.4  65.8  65.6  65.5  62.7  63.5
   S6  25.8  32.1  39.9  52.8  56.5  59.9  60.6  61.6  63.1  62.3  63.0  62.2  60.6  54.9  51.2  55.1  61.7  60.9  62.6  62.9  61.5  61.2  62.5  62.0  62.4  62.9  62.6  62.3  62.0  62.6  64.2  62.7  64.4  64.7  64.6  64.9  61.7  61.9
   S5  40.2  48.8  40.8  36.3  32.4  31.0  30.0  29.7  30.2  30.7  34.1  41.8  39.2  45.2  51.4  55.9  61.7  61.4  62.7  61.1  63.3  61.3  61.8  62.5  61.2  62.6  63.3  61.8  61.5  61.3  64.4  61.3  63.6  64.7  63.1  64.0  60.4  62.0
   S4  34.0  48.1  30.5  21.7  15.6  12.7  10.9  10.3  10.1  10.2  11.7  15.1  15.4  22.0  41.1  54.5  62.1  63.9  65.6  64.6  66.0  63.9  64.7  66.3  65.0  65.7  66.7  64.8  64.9  65.0  70.5  66.9  67.2  67.4  67.9  67.6  63.9  64.0
   S3  48.7  55.4  47.9  43.9  41.0  39.5  38.7  38.2  38.2  38.1  39.2  40.5  40.8  43.5  52.7  58.1  61.5  62.3  63.7  62.4  63.8  62.3  63.0  63.8  62.6  63.0  63.6  62.3  62.5  62.7  66.0  63.4  64.2  64.6  63.8  63.6  61.8  62.3
   S2  61.3  64.5  63.1  60.9  58.3  51.4  36.9  29.2  25.0  23.5  23.1  22.6  27.6  32.5  49.3  55.6  57.6  57.5  59.2  58.4  58.3  58.2  58.2  57.8  58.6  58.7  58.9  57.9  57.9  58.1  59.4  60.3  58.8  58.2  58.7  59.6  58.7  58.9
   S1  64.7  67.1  65.8  64.2  62.4  52.9  34.8  23.3  17.0  14.7  14.2  13.6  21.3  27.1  49.1  57.7  63.0  63.4  64.7  62.8  62.8  62.9  63.1  63.3  63.5  64.0  64.9  62.7  62.6  63.6  64.2  65.3  64.5  65.0  63.9  64.6  61.6  62.6
   S0  72.5  73.9  73.5  71.6  70.7  71.2  69.9  56.2  39.1  29.5  26.8  25.4  26.6  49.6  62.4  68.0  71.1  72.1  71.5  70.0  70.6  71.9  71.1  71.4  72.4  72.4  72.8  70.6  71.0  72.8  71.2  72.5  72.8  72.9  73.0  71.3  68.9  70.5
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S9  68.0  67.9  68.0  67.9  67.8  67.9  68.9  68.4  68.1  68.1  68.1  68.0  67.9  67.9  67.9  67.8  67.9  68.0  68.4  68.0  67.9  68.0  67.9  67.9  67.9  67.8  67.8  67.8  67.8  67.7  68.6  68.0  67.7  67.8  67.7  67.7  67.7  67.7
   S8  19.6  18.1  17.1  16.3  16.4  16.1  16.6  16.9  18.0  19.2  20.0  21.8  22.9  23.4  24.0  24.5  26.1  27.5  29.6  31.8  34.0  36.5  39.3  42.5  45.0  46.9  49.1  51.1  53.5  55.0  57.3  57.7  58.5  59.0  59.3  59.6  59.5  59.3
   S7  28.7  27.5  26.6  26.1  25.5  26.1  27.6  27.9  28.3  28.7  29.9  33.1  35.9  36.5  36.5  37.2  38.4  38.8  40.5  42.1  44.1  47.1  50.6  53.8  55.3  57.3  59.5  61.0  62.5  64.0  65.4  66.0  66.2  66.8  67.2  67.2  67.3  67.3
   S6  26.3  24.6  23.7  23.2  23.1  24.4  25.7  25.9  26.0  26.2  27.8  31.7  34.3  34.8  34.0  34.5  35.1  35.0  36.6  37.9  40.2  44.3  48.1  50.9  52.9  54.8  56.8  58.6  59.8  61.2  62.6  62.9  62.9  63.0  63.5  63.6  63.6  63.6
   S5  41.8  41.7  40.8  40.5  41.3  41.7  43.5  44.5  44.8  44.8  45.3  46.1  47.5  48.0  48.1  47.6  48.1  48.3  49.6  51.6  54.0  56.1  58.6  60.0  60.8  61.5  62.9  64.2  64.5  64.6  65.6  65.4  65.2  65.4  65.5  65.5  65.5  65.6
   S4  37.8  37.3  35.5  34.9  35.3  35.8  37.9  39.0  39.2  38.9  39.4  40.4  42.5  43.4  44.4  45.2  45.5  45.8  47.4  49.3  51.5  54.2  56.6  58.7  59.4  60.5  61.8  63.0  63.6  63.8  65.0  64.6  64.2  64.3  64.3  64.1  64.3  64.3
   S3  46.9  46.3  46.4  45.8  46.5  48.2  50.2  50.3  50.0  49.0  47.7  47.8  48.6  48.4  49.1  49.8  48.2  49.4  52.1  53.2  54.6  57.2  57.3  58.3  58.5  60.1  60.1  61.1  61.9  62.1  62.9  62.8  62.0  62.5  61.8  61.5  61.6  62.1
   S2  56.1  55.7  55.5  55.4  55.1  55.6  56.4  56.0  55.4  54.9  55.0  54.6  55.5  56.3  57.0  58.0  59.4  60.1  61.5  61.3  61.6  62.1  61.9  62.7  62.7  62.9  63.7  64.1  64.6  64.8  65.2  64.9  64.6  64.7  64.7  64.6  64.7  64.9
   S1  55.9  55.3  54.9  54.9  54.3  54.7  54.3  53.5  52.5  52.1  51.6  51.7  52.5  53.0  54.8  56.1  57.3  57.3  58.1  58.2  58.9  59.3  59.7  60.2  61.2  61.6  62.1  62.6  62.7  62.8  63.3  62.7  62.2  62.3  62.4  62.3  62.5  62.5
   S0  62.2  62.2  64.1  65.1  65.8  66.0  66.1  64.6  63.0  62.6  62.1  62.0  63.0  64.8  66.4  66.9  66.6  66.5  66.8  67.7  68.0  69.4  70.0  70.5  71.3  71.3  71.5  71.3  71.1  71.2  71.1  71.1  70.7  70.8  71.3  70.8  71.1  70.7
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S9   323   281   308   289   303   241   220   239   280   246   293   359   383   380   446   370   354   358   317   344   370   331   405   430   418   401   390   446   453   398   454   388   415   473   457   434   363   412
   S8   323   298   284   273   243   217   222   241   280   246   302   359   380   373   445   378   337   355   317   334   387   337   416   419   416   391   383   444   465   391   452   381   426   462   438   434   356   420
   S7   623   572   398   437   381   377   373   403   407   412   464   514   563   593   686   565   508   519   528   529   574   516   560   612   539   567   615   576   623   562   586   534   568   594   571   564   516   567
   S6   500   469   265   348   281   299   288   296   322   319   404   433   486   528   592   500   432   451   405   471   493   450   497   534   484   475   541   515   551   489   532   465   498   505   509   513   458   508
   S5   559   486   317   360   332   317   308   346   354   343   413   479   485   523   582   485   466   462   478   511   545   497   566   568   525   500   567   511   570   505   600   495   535   524   515   529   524   515
   S4   637   546   386   421   326   334   341   320   373   361   457   491   537   632   649   530   530   521   501   553   538   505   602   577   555   550   566   601   606   564   655   564   560   519   600   537   532   571
   S3   466   405   325   352   287   274   286   284   323   326   378   409   415   463   457   414   414   407   407   434   449   439   494   463   471   449   479   469   481   460   537   440   456   443   455   445   446   466
   S2   559   526   574   544   488   459   353   317   312   320   369   360   455   440   494   500   472   456   418   504   448   522   469   547   455   399   494   452   476   544   479   486   469   388   494   490   417   459
   S1   564   527   536   549   497   488   398   379   358   366   405   378   520   513   512   504   522   482   462   548   458   523   529   546   479   496   533   543   537   565   510   505   514   437   528   485   484   492
   S0   578   570   547   573   491   535   425   436   339   364   370   357   464   498   539   510   522   509   465   553   477   549   521   522   506   488   552   551   527   578   506   514   515   469   543   464   488   490
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37
   S9   293   285   282   277   278   276   286   284   305   317   330   327   319   311   325   328   339   349   368   370   387   397   404   406   410   425   422   424   430   420   426   408   409   414   417   418   420   421
   S8   297   286   277   265   268   269   272   275   288   307   325   327   313   306   319   319   331   343   353   368   381   394   400   405   401   422   415   420   421   409   418   402   401   408   407   409   412   413
   S7   484   457   445   437   432   445   449   443   449   469   491   500   488   483   484   487   487   497   511   513   524   537   551   549   548   567   562   563   562   542   553   528   532   541   534   534   536   543
   S6   410   388   370   362   355   363   367   367   369   394   417   433   427   427   421   419   425   437   446   454   462   479   497   489   493   508   510   510   507   496   504   480   476   487   487   487   486   492
   S5   530   521   496   482   475   475   479   477   482   489   510   517   516   514   522   517   519   534   530   515   533   532   553   551   555   565   564   573   572   561   555   541   528   544   548   550   544   544
   S4   546   527   503   484   475   469   483   476   485   489   513   515   526   526   531   528   523   540   531   525   538   540   565   563   566   574   574   581   580   566   570   549   538   549   553   557   553   554
   S3   451   449   444   417   414   412   407   407   412   419   430   425   422   431   433   436   431   447   434   421   436   440   447   457   457   459   470   473   459   462   453   442   426   443   446   436   444   445
   S2   521   520   509   491   484   467   466   476   476   485   498   485   482   505   500   502   499   494   502   467   479   493   501   511   511   506   511   516   509   509   493   488   481   486   491   491   493   500
   S1   541   541   526   512   498   485   479   484   493   498   503   498   502   517   516   513   515   501   508   485   491   503   519   521   521   518   523   527   520   517   509   496   490   496   498   501   500   505
   S0   532   525   518   512   491   486   486   473   490   491   487   483   508   506   516   519   521   496   500   481   483   495   512   500   504   508   497   504   500   495   505   485   479   484   489   485   486   494

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

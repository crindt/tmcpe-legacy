
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S5/
	M1	Time Steps	/0*35/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S5	0.425000
		S4	0.410000
		S3	0.600000
		S2	0.490000
		S1	0.455000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S5   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   1.0   0.0
   S3   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S2   1.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S1   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S5  66.7  62.3  51.8  40.7  34.4  48.8  56.5  61.7  64.0  65.3  64.7  66.9  68.4  69.2  69.7  68.2  69.5  69.4  68.7  69.1  69.2  68.6  69.3  69.2  68.7  68.7  69.5  69.3  69.7  68.9  69.6  69.9  68.9  68.9  69.3  69.2
   S4  68.9  67.3  61.2  42.7  44.1  55.2  61.0  64.7  66.1  67.9  67.0  68.1  69.0  70.1  70.4  69.3  71.2  70.9  71.0  71.3  70.9  70.7  71.2  71.3  71.5  70.8  71.6  71.6  71.0  70.3  70.9  70.7  69.7  69.6  70.5  69.3
   S3  63.0  62.9  63.6  61.4  60.9  61.6  62.7  63.7  63.5  62.7  62.2  63.4  64.0  63.9  64.5  63.4  64.0  63.2  62.9  63.8  63.1  63.2  64.1  64.4  64.4  64.8  65.3  65.9  65.2  64.9  65.4  64.9  64.6  58.7  55.9  57.5
   S2  66.4  65.8  66.7  67.1  66.4  66.2  65.5  65.9  66.3  65.5  65.6  66.1  67.3  67.1  66.1  66.4  66.7  66.2  65.6  65.6  64.9  65.1  65.0  65.5  65.0  65.2  68.2  67.3  66.6  65.9  66.2  65.6  65.1  65.4  65.6  65.2
   S1  66.1  65.2  66.7  66.5  64.7  64.8  64.5  64.1  64.0  63.6  63.2  64.4  64.8  65.2  64.7  65.2  65.2  65.7  65.1  65.4  64.6  64.9  65.1  65.2  64.9  64.8  65.0  65.5  65.4  64.7  65.5  64.6  64.6  64.5  65.5  64.8
   S0  63.5  63.1  63.6  63.8  62.9  62.7  62.3  62.7  62.4  62.2  62.3  62.9  63.2  62.9  63.1  63.1  63.4  62.7  63.6  63.5  62.7  63.1  63.0  62.9  62.9  62.8  62.9  63.0  63.6  62.7  63.3  62.8  63.1  63.1  63.2  62.7
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S5  71.2  71.0  71.1  70.7  70.6  70.7  71.0  71.1  71.2  71.2  71.3  71.2  71.3  71.3  71.5  71.5  71.5  71.6  71.7  71.7  71.8  71.7  71.7  71.8  72.0  71.9  72.3  72.3  72.4  72.5  72.5  72.6  72.5  72.4  72.4  72.2
   S4  71.5  71.4  71.8  71.2  71.2  71.2  71.3  71.3  71.4  71.5  71.5  71.4  71.4  71.4  71.4  71.3  71.3  71.3  71.5  71.5  71.6  71.5  71.7  71.9  72.0  72.0  72.5  72.5  72.6  72.7  72.6  72.5  72.5  72.3  72.4  72.2
   S3  69.4  69.5  69.7  70.0  70.2  70.3  69.9  69.7  69.6  69.7  69.6  69.7  70.0  69.5  69.6  69.6  69.6  69.8  69.4  69.6  69.6  69.5  69.7  69.8  69.9  69.9  70.3  70.1  70.2  70.1  70.1  69.8  69.7  69.0  68.8  68.8
   S2  68.2  68.1  68.6  68.5  68.6  68.4  68.3  68.3  68.2  68.1  68.3  68.1  68.1  68.1  68.1  68.0  67.9  67.8  67.7  67.9  67.8  67.6  67.9  67.9  68.0  68.0  68.4  68.4  68.4  68.6  68.6  68.4  68.2  68.0  68.0  68.0
   S1  68.6  68.4  69.0  68.6  68.5  68.4  68.3  68.3  68.2  68.1  68.3  68.2  68.3  68.2  68.5  68.4  68.4  68.4  68.4  68.5  68.6  68.4  68.6  68.7  68.8  68.8  69.3  69.1  69.2  69.3  69.2  69.1  69.1  68.9  68.9  69.0
   S0  74.4  74.3  74.3  74.3  74.2  74.0  74.2  74.4  74.5  74.5  74.2  74.1  74.1  74.4  74.6  74.4  74.1  74.3  74.3  74.5  74.6  74.4  74.5  74.7  74.4  74.3  74.9  74.9  74.6  74.4  74.6  74.7  74.8  74.9  74.6  74.4
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S5   247   273   138   251   322   306   277   265   281   288   274   307   266   245   244   257   273   258   249   254   256   286   243   251   226   221   224   211   217   205   203   209   192   222   228   180
   S4   251   288   237   260   280   318   285   265   272   307   289   297   261   255   240   262   278   252   250   255   249   299   246   250   240   219   234   211   217   209   204   206   196   223   219   187
   S3   243   263   218   248   231   277   255   241   248   262   298   262   256   231   226   226   262   216   220   238   226   274   225   238   203   194   213   204   209   194   204   190   195   201   191   189
   S2   250   257   246   267   240   253   253   235   261   247   310   265   247   224   241   228   274   222   225   228   223   280   241   225   199   200   226   192   210   190   199   204   199   201   220   160
   S1   254   252   259   270   236   268   253   238   262   250   298   263   250   232   246   230   264   223   231   229   228   276   239   232   192   210   210   190   202   194   210   196   193   211   221   167
   S0   289   307   289   297   279   297   298   290   282   295   323   289   292   275   279   269   315   273   266   289   284   319   282   275   242   242   252   239   244   249   259   232   258   249   265   209
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S5   311   304   299   307   307   300   307   302   300   302   300   297   294   297   295   294   298   295   283   288   276   278   266   270   263   253   245   244   243   229   228   223   213   207   201   189
   S4   313   307   305   311   307   303   308   304   301   304   301   297   297   298   295   297   301   296   284   291   278   282   268   272   265   253   246   247   242   229   228   224   213   208   202   192
   S3   265   261   254   258   258   253   267   258   258   261   250   253   254   258   249   251   254   251   243   251   238   247   231   238   221   221   217   219   205   198   200   194   189   186   173   171
   S2   281   283   279   281   281   276   280   283   277   279   276   275   278   279   272   272   274   273   266   269   256   258   250   254   246   236   226   228   226   214   215   210   204   200   185   182
   S1   286   281   281   285   282   279   280   284   278   277   276   275   278   279   274   274   273   269   269   268   256   258   249   254   243   238   230   229   225   216   217   207   203   200   187   181
   S0   297   292   297   297   302   287   290   305   288   296   290   292   298   291   292   292   287   286   290   282   269   271   263   275   260   255   250   247   245   232   239   223   230   219   212   203

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

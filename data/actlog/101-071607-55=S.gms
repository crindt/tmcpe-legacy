
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S7/
	M1	Time Steps	/0*31/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S7	0.275000
		S6	0.445000
		S5	0.425000
		S4	0.410000
		S3	0.600000
		S2	0.490000
		S1	0.455000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
   S7   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S6   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S5   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S4   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S3   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S2   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S1   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
   S7  34.2  40.0  55.2  60.3  64.8  65.3  66.8  66.6  63.5  63.0  62.0  60.1  60.2  62.0  61.0  47.0  37.0  31.8  33.0  44.3  53.6  59.3  60.7  63.7  64.2  65.0  68.2  70.6  71.0  70.2  72.3  69.0
   S6  27.1  36.0  47.4  51.6  55.6  57.1  58.0  56.0  51.9  49.3  48.5  44.7  47.7  55.3  59.2  52.4  52.9  44.3  44.1  51.3  57.8  59.4  58.8  61.5  63.3  62.2  63.0  65.6  66.2  64.0  64.7  61.1
   S5  42.8  35.1  30.3  27.2  21.3  24.5  21.9  24.0  30.4  32.2  35.7  34.0  45.6  59.9  66.5  68.0  69.0  70.3  71.1  70.9  69.9  68.5  69.3  68.6  68.7  68.1  68.4  69.4  70.0  68.4  67.6  67.6
   S4  40.7  26.7  18.9  14.7  11.1   9.3   8.0   9.0  15.9  20.9  22.0  25.2  47.5  62.2  70.2  71.6  73.0  74.6  75.2  75.7  73.2  71.0  71.6  72.3  71.9  70.5  71.1  72.2  71.9  69.6  68.1  67.5
   S3  58.4  51.0  47.8  46.2  44.6  41.7  40.0  39.6  40.6  44.8  48.4  50.3  57.6  62.4  65.7  66.4  66.9  67.2  67.5  67.6  66.1  65.1  65.1  66.0  65.5  64.5  65.1  66.1  65.9  64.9  63.7  64.4
   S2  64.3  65.1  64.3  47.7  34.7  25.0  21.4  19.2  17.0  28.2  37.1  45.3  60.9  65.5  68.4  69.6  70.2  70.2  69.5  69.9  67.8  67.2  66.1  67.8  64.9  62.6  65.2  67.3  67.7  66.2  65.3  65.0
   S1  65.5  66.4  67.1  61.9  40.2  25.8  18.1  15.1  12.7  18.7  30.7  41.8  60.2  65.5  68.4  70.3  71.1  70.8  70.1  69.5  67.6  67.5  66.3  67.6  66.8  64.9  66.4  67.6  67.6  66.5  65.0  65.2
   S0  62.8  63.3  64.1  61.0  51.5  44.6  40.9  39.7  38.5  41.9  46.4  50.0  59.4  62.0  64.2  65.5  66.0  64.8  65.4  65.4  62.9  63.5  61.8  62.9  62.1  60.5  62.8  62.6  62.8  61.8  59.5  61.1
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
   S7  36.7  33.1  33.0  33.3  33.3  31.9  30.3  30.7  30.8  28.8  27.1  25.5  24.5  24.6  24.6  25.0  25.6  25.1  26.3  28.6  30.2  31.2  32.3  33.4  34.1  35.9  38.1  41.1  43.0  45.1  48.4  51.5
   S6  32.9  30.0  29.2  30.2  29.9  28.9  27.7  27.8  27.8  26.3  25.1  23.2  22.2  22.3  22.3  22.4  22.6  22.3  23.4  25.9  28.2  29.8  30.5  31.0  31.9  33.8  36.5  39.0  40.5  42.8  45.7  48.6
   S5  47.1  44.3  42.0  41.6  41.4  41.4  39.7  38.4  38.3  38.7  38.3  38.0  38.2  38.2  38.8  39.8  40.3  40.2  40.2  41.0  42.4  43.7  45.1  45.9  46.5  46.5  47.7  49.7  51.8  53.8  55.6  56.7
   S4  45.0  41.2  38.3  38.2  38.6  38.1  35.5  32.4  31.9  31.5  31.1  31.3  32.3  32.6  33.5  34.7  35.2  34.5  34.7  35.6  37.2  39.1  40.9  42.2  43.3  43.5  45.0  48.5  50.8  52.7  54.4  56.0
   S3  48.1  44.1  43.3  43.2  44.4  44.9  43.3  39.1  36.2  36.2  35.6  36.3  37.3  37.3  37.7  37.9  37.4  37.0  36.8  36.7  38.0  42.4  45.1  46.3  46.8  47.8  49.0  50.3  51.9  55.0  56.3  57.7
   S2  56.9  55.1  54.2  54.6  53.7  53.2  53.2  52.3  50.2  49.4  50.6  51.1  52.4  52.5  53.1  54.0  53.9  52.3  51.7  51.0  50.7  51.5  52.9  54.1  54.1  53.8  54.5  55.7  56.6  57.0  56.9  57.3
   S1  59.0  58.1  57.7  58.3  57.0  55.1  53.8  52.1  50.6  50.1  50.8  51.6  53.7  54.6  55.4  56.5  56.5  55.9  54.9  53.8  52.7  52.4  53.7  55.5  55.0  54.9  55.5  56.3  57.1  57.2  57.2  57.4
   S0  71.1  71.0  71.1  71.7  71.8  71.0  70.6  69.4  67.5  66.5  68.0  70.5  72.0  72.7  73.2  73.3  73.0  72.9  72.2  71.7  70.4  70.0  70.1  70.0  68.6  67.9  67.9  68.4  69.3  69.2  68.9  69.3
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
   S7   457   431   372   307   327   352   307   481   519   542   494   524   495   463   455   426   391   403   462   506   432   496   479   495   451   501   441   449   491   504   496   538
   S6   450   392   357   273   284   341   303   461   523   532   507   524   530   475   459   391   366   409   391   441   448   483   500   486   496   510   461   467   499   530   476   557
   S5   568   494   437   412   232   331   292   454   599   600   597   629   616   531   549   463   458   504   507   516   520   563   561   597   566   587   549   537   546   603   567   584
   S4   630   503   441   432   232   313   288   410   586   595   597   617   590   525   559   457   470   507   510   527   519   556   565   603   576   581   539   555   547   604   580   597
   S3   517   511   458   447   336   281   263   324   395   447   472   445   459   441   452   386   413   408   427   463   438   466   451   475   476   486   436   456   454   472   459   466
   S2   609   599   539   532   473   311   322   335   335   547   561   565   544   526   513   411   448   452   486   492   478   509   522   511   542   539   527   497   541   519   516   498
   S1   628   618   571   581   529   395   341   368   341   503   592   550   548   534   522   433   458   462   519   495   470   528   524   524   549   540   536   507   540   529   514   510
   S0   601   567   523   536   456   377   306   339   319   460   517   489   506   517   493   462   448   445   515   487   462   517   517   501   504   500   529   490   503   495   515   494
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
   S7   569   553   552   553   530   515   523   540   524   501   488   461   451   452   448   446   455   450   473   498   503   494   496   489   502   516   509   521   518   530   549   557
   S6   491   470   466   477   454   439   436   445   443   425   410   385   373   374   367   363   368   370   386   414   430   429   428   426   429   442   446   456   456   464   485   496
   S5   581   561   554   571   550   543   523   543   553   545   529   514   488   477   484   471   472   480   479   497   519   526   521   522   519   526   524   531   519   529   544   556
   S4   603   577   563   582   564   558   548   547   564   547   537   517   497   492   488   479   481   487   486   497   523   526   527   527   525   533   530   538   527   530   549   566
   S3   475   460   457   447   453   455   436   432   431   437   413   402   396   384   390   384   374   390   393   382   395   426   412   429   418   424   415   431   426   409   422   444
   S2   568   542   538   543   536   547   541   539   532   522   523   506   499   484   481   480   470   467   480   480   474   497   500   504   497   496   488   481   480   486   490   503
   S1   589   566   566   568   566   573   568   565   557   547   543   531   521   509   500   503   493   498   505   506   499   512   520   518   517   513   505   503   493   499   505   519
   S0   555   551   546   554   548   564   564   570   544   543   534   524   525   515   498   502   497   512   517   503   515   531   525   520   515   515   501   506   474   483   504   506

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

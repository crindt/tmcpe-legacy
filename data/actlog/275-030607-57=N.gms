
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S16/
	M1	Time Steps	/0*29/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S16	0.243000
		S15	0.145000
		S14	0.230000
		S13	0.405000
		S12	0.410000
		S11	0.270000
		S10	0.200000
		S9	0.320000
		S8	0.330000
		S7	0.260000
		S6	0.420000
		S5	0.415000
		S4	0.250000
		S3	0.185000
		S2	0.250000
		S1	0.300000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29
  S16   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
  S15   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
  S14   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
  S13   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   0.0   0.0   1.0   0.0   0.0   1.0   0.0   1.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   1.0
  S12   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   0.0   1.0   1.0   1.0
  S11   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
  S10   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   1.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   1.0
   S9   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S8   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0
   S7   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0
   S6   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S5   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S3   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S2   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S1   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29
  S16  51.9  54.2  57.4  57.1  56.6  57.7  58.8  58.9  58.1  57.7  57.7  58.1  57.9  58.9  58.2  59.0  57.3  56.1  55.9  55.0  54.8  55.2  55.3  55.1  56.1  55.9  57.2  56.6  56.8  57.5
  S15  49.4  55.9  60.4  61.6  61.8  63.0  63.2  62.9  62.5  61.8  61.9  63.0  61.7  61.5  60.7  61.8  60.6  61.2  61.7  61.3  61.1  61.4  60.3  61.0  61.1  60.1  61.0  61.0  60.5  61.3
  S14  42.4  49.6  53.9  55.9  57.2  58.9  58.8  58.4  58.7  58.6  58.3  59.2  59.6  58.6  59.0  59.2  58.4  58.1  58.3  59.0  58.9  59.0  58.0  58.6  58.1  58.3  58.0  58.6  58.8  59.3
  S13  29.1  37.7  51.5  58.3  61.1  63.7  64.6  63.8  63.9  64.5  64.6  64.7  65.8  64.2  64.2  63.9  64.5  63.4  64.8  65.4  64.5  65.6  64.7  65.7  65.6  64.6  64.4  64.4  64.8  65.1
  S12  48.2  51.4  56.9  58.2  61.3  61.1  63.5  62.2  61.8  63.7  60.8  62.7  63.7  61.7  62.6  62.7  63.1  61.5  62.0  61.7  62.7  64.0  62.3  62.6  60.2  61.6  60.9  61.2  62.6  62.8
  S11  56.3  53.2  56.9  57.2  58.8  59.7  45.1  44.2  52.4  57.1  57.9  58.7  60.0  59.4  60.0  59.5  59.5  58.4  57.5  58.7  58.2  59.1  58.9  59.9  58.6  58.7  58.7  58.5  58.7  59.5
  S10  58.0  53.1  58.4  58.6  58.7  57.4  36.1  37.2  50.4  55.4  55.8  58.7  61.6  60.2  60.6  59.8  60.1  57.9  57.9  57.6  58.1  58.3  56.6  58.6  57.9  59.4  58.8  55.7  57.7  59.2
   S9  55.1  48.6  54.1  54.4  54.9  41.0  27.7  31.7  44.7  50.9  51.9  54.8  56.5  56.0  55.1  54.4  55.3  53.3  52.7  52.6  52.6  53.4  51.8  53.4  53.3  53.9  53.3  51.6  53.2  53.8
   S8  56.0  45.0  51.5  53.0  40.0  27.5  23.9  21.4  37.0  45.7  49.8  55.5  57.4  56.8  55.7  55.5  56.6  55.6  52.9  55.7  54.9  56.0  56.8  56.1  54.6  56.5  57.3  55.2  54.3  57.4
   S7  59.3  43.6  42.6  47.6  30.9  20.7  24.1  23.1  26.8  36.3  52.2  59.3  60.0  59.4  59.9  62.0  61.7  56.3  60.0  59.5  58.5  56.8  60.1  54.8  57.0  58.7  59.1  56.7  60.6  60.4
   S6  57.0  45.6  34.6  24.0  16.4  12.7  20.7  28.6  27.1  30.1  46.8  53.9  57.2  57.2  57.7  57.6  58.4  58.1  57.1  57.4  56.1  55.1  57.7  56.0  57.2  57.2  56.8  55.6  57.2  57.1
   S5  59.6  51.8  33.1  22.5  16.7  19.9  23.4  23.6  27.5  37.2  45.8  53.6  57.9  59.0  58.8  58.5  60.2  60.0  58.6  58.5  57.3  56.0  58.4  56.9  59.7  58.6  58.6  57.5  58.9  58.8
   S4  56.6  51.2  31.3  21.1  15.8  15.9  18.8  19.0  20.9  23.1  35.1  46.1  51.3  54.0  54.4  55.1  56.1  55.1  54.8  54.5  53.7  53.1  54.7  53.8  54.9  55.1  55.5  53.6  54.8  55.1
   S3  60.1  57.8  41.5  37.5  39.8  30.0  27.4  26.4  27.5  30.3  40.5  51.0  56.7  59.4  59.5  60.1  61.4  61.0  60.6  59.6  59.7  59.2  59.9  60.3  60.0  60.0  60.5  59.3  60.6  61.2
   S2  56.5  54.1  50.1  48.7  49.0  47.3  46.1  45.0  45.0  44.9  48.3  52.5  55.3  56.0  55.8  55.8  56.5  56.3  56.5  55.1  54.7  53.9  55.7  54.5  55.8  55.1  54.8  54.6  55.3  56.1
   S1  53.0  51.0  49.3  49.0  50.7  48.8  48.7  47.4  47.4  46.8  48.0  50.2  52.5  52.7  51.7  44.0  45.6  49.9  51.4  51.0  50.8  49.6  49.3  50.5  50.3  50.9  51.0  49.4  51.0  52.0
   S0  56.5  55.4  54.7  54.4  55.6  55.0  54.1  51.9  51.4  51.6  52.5  54.0  55.8  56.4  55.9  49.6  53.8  55.0  55.0  55.3  54.8  53.3  54.3  53.7  53.9  54.8  51.5  51.2  54.0  55.1
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29
  S16  64.5  64.4  64.5  64.5  64.3  64.5  64.5  64.1  64.4  64.2  64.3  64.4  64.5  64.3  64.2  64.1  64.3  64.2  64.5  64.5  64.6  64.1  64.4  64.2  64.2  64.1  64.4  64.3  64.2  64.1
  S15  65.5  65.3  65.5  65.3  65.3  65.5  65.8  65.3  65.5  65.1  65.4  65.5  65.7  65.1  65.2  65.3  65.4  65.3  65.7  65.6  65.7  65.3  65.4  65.2  65.2  65.3  65.4  65.2  65.0  64.9
  S14  64.9  64.8  64.8  64.8  64.8  65.1  65.1  64.6  64.7  64.5  64.7  64.8  64.8  64.4  64.5  64.6  64.5  64.5  64.4  64.6  64.6  64.4  64.6  64.4  64.3  64.3  64.6  64.6  64.5  64.2
  S13  67.1  66.8  67.1  67.1  67.2  67.8  67.9  67.4  67.7  67.5  67.5  67.7  67.6  67.2  67.0  67.2  67.1  67.1  67.8  67.6  68.0  67.5  67.7  67.5  67.6  67.6  67.7  67.6  67.6  66.7
  S12  64.3  64.1  64.1  63.8  63.8  63.7  63.7  63.4  64.0  64.0  63.8  64.2  64.2  64.2  64.2  64.0  64.0  64.0  64.6  64.4  64.6  64.3  64.3  63.9  63.8  63.6  64.1  63.7  64.1  63.9
  S11  65.6  65.3  65.5  65.5  65.4  65.7  65.3  64.8  65.1  65.2  65.1  65.5  65.4  65.2  65.2  65.3  65.3  65.1  65.2  65.0  65.3  65.1  65.1  65.0  65.0  65.0  65.3  65.1  65.0  64.9
  S10  61.6  61.0  61.4  61.9  61.7  61.9  61.7  61.2  61.8  61.6  61.9  62.0  61.7  61.6  61.7  61.3  61.0  61.1  61.7  62.0  61.7  61.4  61.2  61.6  60.9  61.6  62.1  61.9  62.0  61.8
   S9  64.2  63.9  64.3  64.3  63.9  63.6  63.1  62.9  63.6  63.5  63.7  63.8  64.1  63.7  63.9  63.7  63.2  63.1  63.8  63.9  63.9  63.7  63.6  63.7  63.0  63.1  63.4  63.2  63.2  62.9
   S8  61.5  60.3  60.8  61.1  60.1  59.9  60.3  60.1  61.1  60.9  60.8  60.9  61.4  61.3  61.0  60.7  60.6  60.2  60.6  61.3  61.5  61.6  61.3  61.1  61.0  60.9  60.9  60.9  60.3  60.2
   S7  63.2  63.1  63.0  63.5  62.9  63.1  63.1  62.9  62.8  63.4  63.8  63.6  63.3  62.7  63.4  64.0  63.6  63.3  64.9  64.0  63.9  63.4  63.2  63.4  63.4  62.5  63.0  62.4  61.8  62.0
   S6  64.9  64.7  64.2  64.1  63.6  63.9  64.1  63.7  63.5  63.5  63.7  63.9  64.1  64.2  64.1  64.0  63.7  63.8  64.1  64.1  64.0  64.0  64.1  63.6  63.5  63.2  62.9  63.0  62.9  63.0
   S5  64.8  64.8  64.1  63.6  63.4  63.5  64.0  63.1  62.9  62.9  62.8  62.9  63.9  64.5  64.6  64.2  64.1  64.1  64.9  64.7  64.4  64.1  64.2  63.8  63.9  63.5  63.4  62.8  63.2  63.5
   S4  62.9  62.9  62.4  62.1  62.0  61.9  62.1  61.6  61.4  61.3  60.9  61.0  61.9  62.3  62.4  62.4  62.3  62.3  62.6  62.4  62.5  62.5  62.5  62.3  62.2  62.0  62.1  61.9  62.0  61.8
   S3  67.8  67.7  67.3  67.1  67.2  66.8  67.0  66.5  66.5  66.4  66.0  66.0  66.6  66.8  66.9  67.1  66.9  67.2  67.4  67.3  67.4  67.2  67.1  67.0  67.0  66.7  66.9  66.8  66.8  66.6
   S2  65.6  65.5  65.4  65.3  65.3  65.0  65.2  64.6  64.8  64.5  64.1  64.1  64.6  64.8  65.0  65.1  65.0  65.1  65.2  65.2  65.3  65.2  64.9  64.9  65.0  64.6  65.1  65.2  65.0  64.7
   S1  62.7  62.4  62.3  62.3  62.0  62.1  62.1  61.8  61.5  61.2  60.9  60.9  61.2  61.6  61.8  61.8  61.6  61.9  62.1  61.9  61.9  61.9  61.5  61.8  61.6  61.5  61.4  61.8  61.3  60.9
   S0  63.2  62.8  62.6  62.8  62.6  62.6  62.9  62.5  62.0  61.5  61.4  61.6  61.6  62.0  62.2  62.2  62.1  62.3  62.4  62.4  62.3  62.5  62.0  62.5  62.2  62.2  62.0  62.5  62.1  61.6
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29
  S16   375   384   373   382   395   370   355   339   423   377   392   388   373   380   363   409   373   399   383   396   429   411   427   404   395   419   422   386   381   417
  S15   439   462   432   457   444   450   411   414   507   438   462   462   444   460   460   479   469   457   473   482   509   497   518   486   473   507   487   493   436   506
  S14   443   460   443   457   463   451   409   422   501   454   470   452   454   455   469   512   476   475   469   488   522   484   529   501   472   516   460   494   440   529
  S13   481   500   448   438   439   460   429   415   490   463   464   434   478   475   459   504   449   480   485   483   514   483   552   483   476   510   475   488   443   514
  S12   506   617   468   476   473   500   472   452   511   525   484   474   483   531   506   541   504   504   547   538   548   517   593   490   514   528   501   529   516   541
  S11   416   526   402   404   388   425   395   401   438   450   392   399   433   442   444   459   434   414   463   453   471   453   511   408   483   440   435   447   447   476
  S10   420   559   444   433   413   437   362   463   475   452   432   439   471   460   467   509   450   442   499   502   492   507   525   444   517   470   475   493   487   508
   S9   457   616   493   465   452   417   376   525   496   493   475   476   512   482   507   554   480   469   532   547   526   554   571   486   557   514   535   545   530   549
   S8   380   582   451   401   392   193   478   483   491   414   426   423   463   471   499   493   445   423   500   514   470   520   544   460   527   511   468   479   494   496
   S7   400   594   471   424   348   209   499   503   487   453   454   429   500   483   484   523   484   440   519   513   516   554   534   485   539   493   497   531   532   540
   S6   387   599   520   359   281   305   490   545   540   517   475   467   516   519   500   558   520   473   540   530   564   585   558   546   567   508   521   571   536   546
   S5   327   584   426   334   185   508   501   504   548   572   482   460   514   505   510   558   512   484   506   556   559   576   544   564   554   493   508   585   533   533
   S4   296   558   289   261   131   444   478   481   498   498   476   422   476   446   477   527   459   444   475   513   510   505   520   498   509   464   485   536   512   472
   S3   325   559   209   176   209   473   517   495   522   543   488   447   503   471   519   541   483   465   496   544   534   533   540   537   522   504   515   570   547   514
   S2   341   610   308   304   205   513   541   546   547   583   543   501   516   505   567   561   526   492   532   586   578   564   582   581   547   546   537   607   602   518
   S1   185   428   214   204   116   356   385   349   385   382   389   335   348   340   335   381   361   314   373   392   377   367   410   398   373   373   357   397   406   334
   S0   178   424   237   228   117   387   393   363   406   398   390   339   343   341   325   374   377   312   373   381   385   369   400   410   394   368   365   413   408   340
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29
  S16   397   397   398   406   413   407   407   406   405   419   409   416   411   410   416   426   419   421   418   418   415   425   433   434   438   436   442   440   440   437
  S15   437   434   434   443   448   444   446   449   443   457   452   456   449   446   452   464   459   458   454   454   451   466   469   473   480   478   476   478   474   473
  S14   445   440   442   450   454   454   457   459   457   470   462   464   462   461   467   476   472   476   465   467   467   482   481   486   492   489   490   489   493   487
  S13   430   428   427   435   440   439   442   443   446   458   447   451   450   445   453   464   463   461   459   453   456   469   470   471   478   481   480   484   474   469
  S12   474   473   469   477   484   485   492   496   492   510   498   505   507   506   509   516   519   517   515   513   511   523   525   523   531   531   533   535   531   521
  S11   400   402   401   402   404   410   411   413   413   426   411   420   422   416   418   431   431   430   427   425   434   442   449   442   452   455   456   453   451   432
  S10   425   426   427   423   432   434   438   439   441   450   444   442   450   444   453   455   461   458   457   455   469   471   478   468   479   481   491   482   481   464
   S9   484   491   491   487   492   500   502   501   505   514   506   509   510   513   523   532   530   526   535   529   537   547   551   546   553   561   565   561   558   542
   S8   416   426   423   422   422   427   434   442   438   443   433   438   439   444   442   452   449   452   450   453   456   468   472   467   470   484   478   478   471   465
   S7   437   443   442   443   441   450   455   464   460   467   460   464   464   470   466   481   476   477   479   477   483   492   492   494   498   509   505   507   498   494
   S6   461   464   470   465   464   480   485   490   492   492   491   490   495   501   495   507   507   503   506   507   515   522   523   527   524   541   540   534   530   526
   S5   459   465   465   460   456   482   489   480   498   487   494   486   494   497   490   502   505   500   508   504   514   516   524   525   524   537   534   531   530   530
   S4   425   433   431   428   427   445   451   444   461   451   457   451   461   456   453   465   467   459   463   465   469   471   482   477   480   493   493   492   488   485
   S3   448   455   450   450   451   467   470   466   486   476   480   473   485   481   477   491   490   482   492   489   494   499   508   506   506   516   519   525   516   516
   S2   471   484   477   479   478   493   499   492   510   502   508   505   508   510   506   517   518   508   520   517   523   529   530   532   531   543   544   549   545   538
   S1   318   329   326   327   327   331   342   331   343   337   342   344   343   341   339   345   346   344   352   343   351   357   358   362   360   371   369   367   369   360
   S0   318   329   328   328   330   334   345   335   347   339   349   346   342   344   341   346   349   347   353   344   352   355   362   361   367   369   372   367   368   363

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;


$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S9/
	M1	Time Steps	/0*33/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S9	0.630000
		S8	0.590000
		S7	0.605000
		S6	0.485000
		S5	0.380000
		S4	0.380000
		S3	0.395000
		S2	0.270000
		S1	0.240000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33
   S9   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S8   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S7   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S6   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S4   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S3   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S2   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S1   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33
   S9  69.7  69.6  69.7  68.1  67.5  66.4  67.1  65.0  63.5  65.6  67.2  66.9  66.6  66.1  64.9  65.1  61.1  62.9  64.2  64.8  63.4  64.2  64.4  64.4  63.4  64.4  63.6  65.3  65.9  66.7  63.3  64.2  64.6  65.3
   S8  70.4  69.8  69.4  69.4  68.5  68.1  68.2  67.1  65.0  65.8  67.0  67.1  67.5  66.4  66.1  66.5  62.2  63.0  63.7  64.2  63.2  65.3  64.1  64.3  62.0  64.1  62.5  65.3  64.4  65.9  63.1  63.7  63.9  64.2
   S7  67.1  67.4  66.5  66.8  65.2  65.7  65.7  65.2  63.1  62.4  64.5  64.6  65.5  63.7  63.9  64.6  60.2  60.4  62.4  62.5  60.9  62.1  60.3  61.7  61.1  62.3  61.0  60.4  63.2  63.3  60.6  63.3  63.7  62.7
   S6  69.1  68.8  69.2  68.6  68.2  68.5  68.4  67.8  67.3  66.1  67.9  67.8  68.6  68.5  69.3  69.7  66.3  65.6  68.4  68.9  68.2  67.1  66.5  66.7  66.6  67.6  66.5  66.3  68.6  68.5  65.6  67.3  67.8  68.5
   S5  65.1  64.5  65.7  65.4  64.6  65.3  65.6  65.7  64.9  63.8  65.3  64.9  65.5  65.6  65.5  66.1  63.1  61.4  65.6  64.5  64.3  63.4  64.1  63.6  64.3  63.7  63.0  62.1  66.0  65.3  62.4  63.5  64.8  65.4
   S4  57.1  63.4  65.6  65.8  65.4  65.6  66.3  67.6  66.2  65.3  66.4  66.1  67.0  67.1  66.1  66.0  64.0  61.8  65.7  65.9  65.5  64.5  64.5  64.6  64.9  64.3  63.7  64.2  66.3  66.3  64.0  65.1  65.9  65.9
   S3  57.4  62.7  65.2  64.5  64.4  63.9  65.1  67.4  65.8  64.4  66.9  66.5  66.2  65.7  65.5  65.0  63.7  60.9  64.4  64.9  64.9  63.4  63.5  64.1  65.1  63.6  63.1  62.5  65.3  65.4  63.1  64.4  65.3  65.6
   S2  28.7  36.6  50.7  57.8  55.3  54.0  58.0  59.8  60.1  59.0  60.9  61.7  60.8  60.9  60.5  59.4  57.9  55.8  59.0  59.4  58.9  58.0  57.9  57.8  58.8  57.8  57.5  56.7  58.8  58.9  57.0  57.5  58.2  59.0
   S1  44.2  42.3  44.4  44.9  43.3  45.7  45.6  55.1  60.1  62.2  62.8  64.9  64.4  63.8  63.4  61.7  60.8  60.3  63.0  63.7  62.1  60.9  61.1  61.4  62.2  60.7  60.2  60.1  61.7  62.5  60.5  60.2  61.1  61.6
   S0  60.2  60.2  60.3  60.2  60.2  60.3  60.8  61.9  61.6  61.5  61.8  61.8  61.9  61.9  61.8  61.6  61.6  61.3  61.2  62.3  61.7  61.5  61.2  61.1  61.0  61.1  61.0  61.0  61.0  61.0  60.6  62.2  61.3  61.3
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33
   S9  68.0  67.7  67.3  67.2  66.9  66.3  66.2  66.0  65.2  65.1  64.6  64.2  64.1  63.6  63.4  63.2  62.5  62.2  62.0  62.7  62.0  62.4  62.0  61.9  62.4  61.9  61.7  62.6  63.0  62.6  62.2  62.9  62.9  63.2
   S8  70.3  70.0  69.6  69.0  69.0  68.5  68.1  68.1  67.2  67.2  66.8  66.4  66.3  65.8  65.5  65.4  65.0  64.7  64.2  64.8  63.9  64.3  63.9  63.9  64.3  64.0  63.6  64.2  64.5  64.1  63.7  64.5  64.2  64.4
   S7  66.7  66.3  65.8  65.1  64.8  64.2  64.2  65.0  64.2  63.7  63.6  63.2  63.5  63.1  62.8  62.6  62.2  61.9  61.9  62.2  61.4  61.4  61.3  61.3  61.5  61.1  60.7  61.1  61.5  61.2  60.2  61.3  60.6  60.7
   S6  66.9  67.1  66.9  66.5  65.9  65.8  65.8  66.4  66.5  66.0  65.6  65.1  65.8  65.6  65.8  65.5  65.2  65.0  64.9  65.2  64.5  64.1  63.6  62.9  62.7  62.6  62.6  63.3  63.4  63.0  61.9  62.9  62.1  62.5
   S5  63.2  63.5  63.5  63.5  63.2  62.8  62.7  63.6  63.7  62.9  62.8  61.8  62.5  62.5  62.8  62.9  62.7  62.5  62.3  62.3  61.0  60.7  60.5  60.0  59.9  59.9  59.3  59.6  59.9  59.3  58.5  59.3  58.4  58.6
   S4  61.4  61.9  61.9  62.3  62.9  62.9  63.0  64.1  64.4  63.7  63.4  62.1  62.9  62.9  63.0  63.4  63.3  62.9  62.9  62.6  61.5  61.7  61.7  61.3  61.1  61.3  60.1  60.5  60.3  60.3  59.4  60.5  59.4  59.3
   S3  63.9  64.5  64.7  65.1  65.2  65.4  65.5  66.5  66.6  66.4  66.6  66.3  66.2  66.4  66.5  66.3  66.1  65.8  66.1  65.9  65.3  65.3  65.6  65.4  65.4  65.4  64.9  65.6  65.6  65.7  65.2  65.6  64.9  65.1
   S2  47.2  47.8  49.8  50.9  51.2  52.3  53.5  55.2  55.5  55.9  55.9  55.0  54.8  54.2  55.1  55.4  55.3  54.8  55.2  55.7  54.9  55.2  55.5  55.1  54.4  54.5  53.9  53.4  53.6  53.6  53.1  53.2  53.0  53.2
   S1  46.9  47.8  49.6  50.5  52.1  53.6  54.4  56.6  57.1  57.7  57.4  55.6  55.1  54.5  55.3  56.0  56.5  56.5  56.7  56.9  56.1  56.6  57.4  56.8  56.7  56.6  56.3  55.6  55.5  55.6  55.3  55.9  55.6  55.5
   S0  44.9  46.3  47.0  48.3  48.5  50.4  50.7  52.5  53.0  53.9  53.9  52.2  52.0  52.6  53.2  53.3  52.9  53.5  53.9  55.0  54.9  55.1  56.0  54.8  54.9  54.4  54.2  53.3  53.3  53.7  53.7  54.7  54.2  54.0
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33
   S9   317   329   330   346   358   316   334   341   344   323   309   321   326   332   337   344   400   349   329   348   322   323   331   314   350   338   331   284   295   319   334   304   321   291
   S8   319   322   320   344   336   309   324   321   353   316   298   321   319   319   331   323   370   359   330   332   317   323   321   305   339   338   315   284   273   322   308   302   306   280
   S7   349   366   340   372   362   340   339   371   372   349   307   346   340   331   353   354   367   382   355   363   325   353   330   334   347   344   348   331   292   336   316   339   322   297
   S6   398   391   379   400   399   374   373   367   378   373   341   368   356   341   375   383   379   430   372   384   346   371   353   363   354   362   369   360   322   344   346   349   332   323
   S5   447   417   426   439   427   411   406   406   428   395   385   385   391   377   408   421   402   469   411   408   384   402   393   400   385   391   398   385   346   366   380   374   362   355
   S4   495   473   475   477   476   464   460   456   493   442   447   429   451   430   455   484   466   502   467   475   445   442   435   439   435   437   439   426   414   427   429   439   411   404
   S3   353   324   337   330   337   357   324   352   337   326   348   336   341   321   340   355   358   350   341   360   342   337   337   354   352   348   346   342   321   357   347   343   341   337
   S2   525   465   448   514   466   508   448   443   478   456   463   422   451   432   455   491   456   537   465   486   446   457   441   465   462   459   462   441   437   436   420   445   425   411
   S1   528   467   507   530   464   519   471   470   478   421   471   401   466   442   452   495   468   522   479   458   499   447   456   422   468   430   479   437   441   429   427   449   396   416
   S0   486   486   488   496   490   490   482   483   463   464   468   465   470   474   472   480   476   470   457   455   437   435   429   429   434   422   432   438   434   437   422   432   420   427
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33
   S9   328   319   323   328   326   317   315   321   320   334   326   308   330   332   319   332   342   356   338   339   334   315   343   328   331   334   329   328   321   330   336   336   330   321
   S8   322   313   315   323   319   307   309   310   310   326   318   298   323   320   312   324   333   341   331   329   325   305   337   322   318   328   318   319   310   321   326   326   320   312
   S7   352   346   340   346   351   335   334   340   336   353   342   324   344   344   339   348   358   361   359   352   348   328   357   341   342   348   339   339   332   335   347   348   339   329
   S6   388   377   371   370   381   365   364   359   362   375   367   355   362   367   363   371   382   384   380   376   369   349   374   366   364   366   360   358   353   356   360   365   355   349
   S5   430   415   410   408   423   403   400   400   393   404   403   389   394   396   395   405   409   418   412   409   400   382   402   399   392   398   389   388   382   383   391   395   384   382
   S4   460   451   451   454   458   446   437   444   444   445   447   431   441   440   441   450   455   462   454   453   448   431   445   442   437   438   437   432   432   427   433   444   427   425
   S3   321   320   319   321   320   325   317   336   322   326   329   329   334   341   343   340   341   344   338   343   340   334   336   337   346   342   343   347   342   341   343   346   342   340
   S2   463   462   467   482   474   468   446   453   456   452   456   443   452   449   463   473   471   477   466   467   462   450   452   459   453   450   451   452   447   444   440   452   442   449
   S1   462   469   479   483   478   471   449   462   462   448   461   449   457   454   471   475   477   480   467   469   465   453   455   458   455   453   455   456   447   440   443   464   442   457
   S0   552   576   570   580   568   568   543   536   534   529   531   529   524   527   529   541   545   552   533   525   525   518   518   520   505   512   513   508   509   505   497   516   501   519

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;


$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S8/
	M1	Time Steps	/0*34/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S8	1.795000
		S7	0.410000
		S6	0.600000
		S5	0.495000
		S4	0.365000
		S3	0.240000
		S2	0.405000
		S1	0.405000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34
   S8   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S7   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S6   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S5   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S4   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0
   S3   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S2   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S1   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   0.0   0.0   1.0   0.0   1.0   1.0   1.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34
   S8  67.3  68.2  68.5  67.3  66.9  66.5  66.4  66.9  66.8  67.0  66.0  66.2  67.4  68.5  68.8  68.1  67.7  68.6  68.2  68.4  67.1  68.3  68.1  67.3  68.5  69.4  68.9  69.3  68.4  69.5  69.1  68.4  67.7  67.0  66.2
   S7  68.0  69.2  69.0  68.9  67.7  69.2  68.3  68.5  68.6  68.8  67.8  67.9  68.5  69.3  68.6  68.3  68.7  68.7  68.2  69.2  68.1  68.6  68.6  68.1  68.5  69.6  69.8  68.9  69.2  70.2  70.5  69.3  68.6  69.3  68.0
   S6  65.7  66.6  67.3  65.1  65.8  65.9  65.2  65.1  65.8  65.6  65.2  65.4  65.7  65.9  65.2  64.6  65.4  65.1  65.5  65.5  64.9  65.3  65.5  65.8  66.3  67.1  67.4  66.7  66.7  66.9  67.2  66.5  65.8  66.5  65.6
   S5  67.1  68.1  68.7  66.8  66.0  65.0  64.9  64.9  65.7  65.9  66.4  66.9  68.2  68.3  69.3  68.7  68.6  69.0  68.9  69.3  68.2  68.4  68.2  67.2  68.8  68.6  68.6  68.1  67.3  67.1  66.9  66.5  66.3  68.0  66.4
   S4  67.3  67.8  67.5  65.1  66.1  66.9  67.1  66.5  66.3  67.2  65.8  65.9  66.9  66.6  67.8  66.2  67.6  68.9  67.7  67.5  67.6  66.5  66.5  67.0  66.7  67.3  68.0  67.4  67.5  67.4  67.1  65.7  66.0  67.2  67.1
   S3  70.8  71.4  70.0  63.9  63.9  65.0  64.4  65.2  66.4  68.2  68.2  69.6  70.6  70.2  69.4  69.4  70.5  70.8  70.7  70.7  70.6  70.4  69.7  69.8  69.5  68.6  69.0  68.4  68.8  69.3  69.8  69.0  69.2  69.8  68.4
   S2  69.0  68.5  63.2  49.7  40.0  35.4  34.2  34.0  41.3  50.1  57.3  63.3  66.4  67.7  66.6  66.9  68.5  69.7  69.8  70.4  70.0  68.9  69.4  68.3  68.3  68.4  69.5  68.8  69.9  70.3  70.9  69.3  69.5  68.8  68.5
   S1  61.2  52.2  46.1  42.2  41.0  39.7  39.9  40.1  40.2  38.8  48.1  54.3  58.7  61.3  61.6  61.4  61.6  61.6  61.8  63.0  62.1  61.1  60.9  60.3  60.3  60.7  61.3  60.2  60.7  60.0  60.8  60.2  60.3  59.7  60.4
   S0  52.0  49.9  50.5  48.9  48.3  48.4  49.6  49.5  49.5  47.5  50.0  51.6  52.5  53.1  52.1  52.4  52.4  52.7  52.6  53.0  52.2  53.0  52.5  50.2  52.6  53.2  51.1  50.8  50.7  50.0  52.5  50.1  51.9  51.6  51.4
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34
   S8  67.1  67.2  67.2  67.1  67.5  67.5  67.5  67.3  67.2  67.0  66.9  66.8  66.9  66.9  67.1  67.0  67.2  67.1  67.0  66.8  66.6  66.6  66.6  66.7  66.8  67.1  67.1  66.9  67.4  67.1  67.0  67.1  67.0  66.9  66.8
   S7  67.7  67.6  67.6  67.7  67.7  67.7  67.8  67.8  67.8  67.9  67.8  67.7  67.8  67.8  67.7  67.7  67.8  67.7  67.7  67.8  67.2  67.2  67.4  67.4  67.6  68.0  68.1  68.1  68.3  68.3  68.1  68.1  68.1  68.1  68.0
   S6  67.6  67.4  67.3  67.3  67.4  67.3  67.4  67.1  67.0  66.9  67.3  67.3  67.2  67.3  67.3  67.3  68.0  67.7  67.5  67.3  67.2  67.0  67.0  67.1  67.0  67.1  67.2  67.3  67.3  67.2  67.3  67.2  66.9  66.9  66.9
   S5  66.9  66.9  66.8  66.9  67.5  67.2  67.2  67.1  67.0  67.0  67.2  67.2  67.1  67.1  67.1  66.8  67.8  67.7  67.4  67.2  67.2  67.1  67.2  67.5  67.4  67.4  67.5  67.5  67.6  67.5  67.5  67.5  67.4  67.4  67.3
   S4  66.2  66.4  66.1  66.0  66.5  66.4  66.2  66.2  66.3  66.2  66.3  66.6  66.5  66.6  66.7  66.5  67.1  67.2  67.1  66.8  66.9  66.9  67.0  67.2  67.3  67.1  67.2  67.5  67.9  67.6  67.6  67.5  67.1  67.1  67.3
   S3  68.0  68.0  67.9  67.7  68.1  68.0  67.9  67.9  68.1  67.7  67.8  67.8  68.0  67.9  67.8  68.0  68.5  68.4  68.4  68.0  67.9  68.0  68.1  68.1  68.1  68.0  67.8  68.1  68.1  67.8  67.6  67.7  67.5  67.2  67.2
   S2  66.1  66.0  65.8  65.5  65.8  65.6  65.5  65.6  65.8  65.6  65.8  66.2  66.3  66.3  66.2  66.3  66.8  66.6  66.6  66.6  66.6  66.6  66.5  66.6  66.6  66.7  66.5  66.8  67.4  66.9  66.8  66.8  66.8  66.7  66.8
   S1  62.8  62.4  62.1  62.0  62.8  62.5  62.4  62.5  62.3  62.2  62.5  62.5  62.8  62.7  62.5  62.5  62.9  62.9  62.8  62.8  62.6  62.6  62.6  62.6  62.5  62.7  62.3  62.1  62.9  62.6  62.3  62.3  62.2  62.0  62.0
   S0  56.0  55.9  55.9  55.8  56.1  55.7  55.6  55.5  55.5  55.6  55.7  55.7  55.3  55.4  55.3  55.4  56.2  56.2  55.9  55.7  55.7  55.9  56.1  55.6  55.5  55.6  55.1  54.9  55.5  55.5  55.6  55.5  55.4  55.3  55.1
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34
   S8   234   205   229   234   194   214   245   225   203   235   197   235   228   194   221   216   245   198   218   234   220   209   264   238   232   252   245   238   254   258   231   240   252   237   225
   S7   240   206   217   243   205   206   242   245   202   219   214   237   207   208   223   208   243   222   209   228   236   215   246   252   242   226   253   243   243   263   236   243   246   259   226
   S6   258   282   259   255   254   257   264   274   262   236   230   276   246   238   281   223   243   259   241   231   279   264   258   270   264   276   260   286   268   266   283   286   270   273   281
   S5   282   329   279   281   291   294   308   300   300   258   252   326   277   250   310   261   254   301   291   263   304   319   300   290   317   310   281   309   305   296   325   327   306   286   328
   S4   241   282   230   263   242   252   254   249   253   245   208   282   232   213   256   269   229   256   264   228   261   265   280   274   273   308   264   262   290   271   273   313   290   257   292
   S3   224   247   232   226   210   223   230   228   238   219   190   246   229   195   233   242   215   233   242   215   233   234   274   272   242   279   255   235   275   249   252   289   272   237   263
   S2   232   252   233   221   219   228   236   227   245   224   193   241   226   206   235   237   221   236   238   218   236   239   270   274   240   280   262   230   281   251   256   288   276   243   265
   S1   323   298   272   278   297   293   329   327   353   347   273   298   297   297   308   327   315   323   315   322   339   329   341   383   344   351   361   330   380   366   351   363   373   345   327
   S0   237   200   173   186   195   194   215   205   220   195   201   199   208   216   212   220   216   236   235   220   243   218   228   262   259   230   235   243   246   262   251   252   250   248   215
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34
   S8   209   203   209   214   203   203   228   213   209   229   213   211   227   221   213   216   224   211   218   232   215   209   228   218   216   229   225   211   220   234   229   222   239   223   221
   S7   218   204   202   215   208   201   220   221   210   214   220   212   214   228   220   209   223   220   216   225   227   214   215   228   219   215   238   215   218   234   239   226   232   241   227
   S6   278   284   276   274   285   277   284   293   282   274   280   283   277   278   283   276   269   284   277   274   285   275   265   280   286   278   279   278   274   275   301   283   279   295   286
   S5   281   290   284   276   294   291   292   295   296   283   278   294   287   278   291   286   273   286   290   282   282   290   276   275   293   288   278   285   285   280   302   301   287   292   303
   S4   257   259   264   257   256   268   270   266   270   266   258   268   271   264   267   277   264   267   280   273   266   277   277   269   280   288   280   280   292   285   290   299   290   281   295
   S3   239   236   242   240   236   247   252   247   244   248   238   240   247   242   239   248   242   237   249   250   238   244   249   240   244   258   250   242   255   255   255   262   265   251   258
   S2   239   235   241   240   234   243   252   247   241   247   240   237   244   243   237   243   242   238   245   248   239   241   247   241   241   256   252   240   252   254   254   257   264   253   252
   S1   332   327   327   322   320   320   333   332   319   321   323   318   321   324   316   318   323   321   324   333   327   323   327   330   331   338   339   330   336   340   351   347   352   347   339
   S0   227   227   224   221   221   219   224   226   223   214   220   218   219   223   216   218   225   223   223   225   225   224   221   228   230   228   229   231   229   230   242   239   240   236   236

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

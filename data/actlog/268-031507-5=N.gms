
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S9/
	M1	Time Steps	/0*40/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S9	0.630000
		S8	0.590000
		S7	0.605000
		S6	0.485000
		S5	0.380000
		S4	0.380000
		S3	0.395000
		S2	0.270000
		S1	0.240000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40
   S9   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   0.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S8   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S7   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S6   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S5   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0
   S4   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S3   1.0   0.0   1.0   1.0   1.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S2   1.0   0.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   0.0   1.0   1.0
   S1   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0
   S0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40
   S9  59.8  59.6  58.5  62.5  63.1  61.1  60.9  60.8  60.4  62.6  63.9  61.9  62.8  60.3  61.8  63.4  64.4  61.4  61.3  61.9  58.9  63.5  61.0  64.4  60.9  62.7  64.0  64.1  63.5  64.5  64.6  64.3  60.2  62.0  59.5  62.7  62.6  60.6  65.0  65.3  64.1
   S8  61.3  61.5  59.8  65.3  64.6  63.1  44.7  34.7  38.2  53.1  60.2  60.4  63.0  62.1  62.5  64.3  65.0  63.4  62.8  63.4  61.5  65.0  62.6  66.6  63.5  64.1  65.3  66.2  65.0  67.0  66.5  66.3  63.3  63.5  61.9  64.7  64.3  63.2  66.6  67.5  67.6
   S7  60.6  61.8  59.2  64.1  65.1  41.1  26.1  18.1  15.4  19.2  40.7  50.9  59.3  60.4  60.9  62.8  63.6  61.8  61.7  62.0  59.9  61.4  60.2  64.3  62.4  62.4  63.6  64.2  63.5  64.4  63.6  63.8  61.2  62.3  59.5  62.1  63.4  61.0  63.6  62.7  63.8
   S6  61.2  62.6  56.0  35.6  24.1  17.8  13.4  11.8  12.1  13.8  18.1  18.2  29.3  46.5  54.3  58.3  61.4  62.5  61.7  60.3  59.5  60.1  59.2  61.9  60.5  61.2  61.9  61.5  61.3  62.3  61.8  62.5  59.3  60.7  58.4  59.6  60.9  58.5  61.3  62.0  63.7
   S5  55.4  58.1  33.3  20.8  15.2  11.7   9.8  10.0  10.3  13.3  15.2  14.2  27.4  40.7  47.7  53.3  57.1  58.0  56.8  54.9  54.0  54.7  54.2  57.2  56.6  55.9  58.1  58.1  56.4  57.7  56.8  58.3  55.3  54.8  54.5  55.6  57.1  54.7  56.7  56.5  58.4
   S4  61.4  39.2  23.3  15.6  12.5  12.0  11.1  11.9  11.7  12.2  13.6  13.1  14.4  31.0  47.8  57.7  61.0  64.0  63.5  61.8  62.3  61.5  61.5  62.3  62.6  63.9  66.0  66.2  63.0  65.5  65.4  65.6  62.2  64.0  61.8  62.6  64.5  61.4  64.0  64.9  66.4
   S3  62.2  61.3  67.0  68.0  72.4  60.8  62.6  61.7  58.0  57.4  60.8  59.2  58.0  59.4  61.9  65.1  65.6  66.0  64.7  65.0  65.5  64.2  64.6  64.2  65.9  65.7  66.8  67.6  64.3  67.1  67.6  67.4  64.0  66.0  64.2  64.4  67.5  63.8  66.3  68.2  70.0
   S2  52.2  45.1  54.0  54.1  48.0  57.3  57.6  57.8  55.2  55.7  56.7  54.1  52.7  54.8  56.0  57.9  58.5  59.8  59.1  57.7  57.9  56.7  57.8  58.1  60.5  59.5  58.7  60.8  57.5  59.2  59.2  61.5  56.9  57.5  57.2  56.3  59.0  58.2  57.1  60.4  60.0
   S1  57.0  56.1  60.2  58.1  52.1  59.7  60.0  59.8  58.0  57.6  57.0  55.9  55.5  56.8  56.2  57.2  59.7  60.1  59.0  57.6  58.2  57.5  58.8  58.0  60.4  59.1  58.1  60.3  58.4  58.8  58.8  61.4  57.4  57.7  56.8  56.3  59.1  57.8  56.8  61.2  60.8
   S0  56.7  57.2  60.6  59.6  53.6  60.1  61.6  60.6  58.8  57.8  56.6  56.8  55.3  57.0  56.8  59.0  60.0  59.0  60.0  58.2  58.9  58.1  59.1  57.3  61.2  58.9  59.8  60.6  59.0  57.5  58.2  59.0  57.9  57.3  60.2  57.4  58.4  58.9  56.3  60.1  60.0
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40
   S9  61.7  62.1  62.3  62.4  62.2  62.6  62.4  62.7  62.9  62.4  63.3  63.1  63.0  63.5  63.6  63.9  63.9  63.7  63.7  63.3  62.7  62.5  63.6  63.4  62.9  62.6  63.2  63.1  62.9  63.2  63.3  63.7  63.2  62.7  63.1  63.1  62.8  63.5  63.7  63.2  63.7
   S8  63.6  63.9  64.0  63.9  64.0  64.4  63.8  63.4  64.0  63.7  64.3  64.5  64.6  64.9  64.6  64.9  64.6  64.6  64.7  64.5  63.4  63.8  64.6  64.1  63.7  63.2  63.8  63.6  63.7  64.0  64.2  64.3  64.2  63.6  64.1  63.9  63.6  64.2  64.5  64.4  64.8
   S7  62.0  62.7  63.2  63.4  63.5  63.4  62.9  62.7  63.2  63.0  63.9  64.1  64.1  64.0  63.8  63.5  63.6  63.4  63.3  63.1  62.5  62.5  63.2  62.8  62.7  61.7  62.4  61.9  62.2  62.5  62.5  62.5  62.6  62.1  62.4  62.6  62.1  62.7  63.4  62.7  63.2
   S6  62.6  63.1  62.8  62.4  62.3  63.0  62.5  61.9  61.9  62.4  62.6  62.5  62.2  62.5  62.1  62.3  62.5  62.4  62.5  62.3  61.6  61.7  62.8  62.7  62.2  61.8  62.0  62.0  61.8  61.7  61.8  61.7  62.3  62.2  62.8  62.6  62.4  62.7  63.3  62.9  63.2
   S5  56.3  57.1  56.5  56.3  56.2  55.9  55.3  54.4  54.4  55.1  55.9  56.3  56.0  56.7  56.6  57.2  57.3  57.4  57.4  57.3  56.6  56.9  58.1  58.2  57.7  57.3  57.6  58.0  57.8  57.6  57.7  57.8  58.1  58.4  59.4  58.9  58.8  59.2  59.9  59.2  59.8
   S4  60.5  60.1  60.9  61.5  60.7  60.0  58.9  57.9  57.6  58.2  58.9  59.4  59.3  60.2  61.3  61.9  62.2  62.1  62.2  62.2  61.5  61.3  63.1  63.0  62.5  62.3  62.9  62.9  62.4  62.1  61.8  61.9  62.5  62.7  63.6  63.1  62.7  63.0  63.8  63.4  63.6
   S3  65.5  65.8  66.1  66.3  66.0  65.5  65.3  64.7  64.8  65.0  65.3  65.4  65.0  65.5  66.1  66.3  66.4  66.3  66.5  66.7  65.8  65.7  67.1  67.0  66.5  66.3  66.3  66.7  66.2  66.0  65.7  65.9  66.3  66.2  66.6  66.2  66.1  66.2  66.6  66.4  66.7
   S2  58.5  58.0  57.9  58.2  58.0  57.4  56.8  56.3  56.5  56.5  56.5  57.0  57.1  57.9  58.3  59.2  59.4  59.4  59.5  59.5  59.0  59.0  59.8  60.2  60.1  59.8  60.2  60.4  60.1  60.0  59.6  59.6  60.5  60.1  60.9  60.5  60.4  60.1  60.7  60.8  60.6
   S1  60.8  60.4  60.1  60.3  60.2  59.5  59.1  58.7  58.4  57.8  58.1  57.7  57.3  58.3  58.8  59.5  59.4  59.8  59.5  59.4  58.7  59.1  59.6  60.2  60.2  60.2  60.4  60.5  60.5  60.3  60.3  60.2  61.0  60.9  62.1  61.6  61.8  61.6  62.4  62.6  62.2
   S0  58.5  58.1  58.4  58.5  58.7  58.4  57.8  56.8  56.3  56.5  56.8  56.9  56.9  57.7  57.6  58.1  58.0  58.4  58.4  58.2  57.7  57.2  57.6  58.0  57.7  57.0  57.2  57.2  57.1  57.0  57.2  57.4  57.7  57.8  58.6  58.1  58.3  58.3  58.9  58.9  58.8
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40
   S9   509   433   328   350   334   351   345   323   317   341   420   333   321   338   281   335   331   349   346   299   340   292   338   294   351   307   309   338   337   274   266   317   362   280   352   322   283   360   259   308   284
   S8   496   416   327   353   305   340   308   333   310   331   394   335   287   344   288   289   325   342   326   322   290   299   325   286   330   297   300   320   338   267   258   302   336   289   341   315   273   346   264   273   283
   S7   515   458   373   378   357   240   291   304   368   421   419   376   303   351   287   293   365   360   360   339   334   315   333   308   335   306   328   310   372   298   285   318   336   322   353   340   324   362   312   290   313
   S6   534   510   398   359   196   139   307   347   368   438   495   410   358   361   320   289   380   386   364   338   324   360   372   360   319   344   358   333   407   306   305   344   339   361   380   358   333   409   339   299   334
   S5   596   536   361   351   117   277   331   395   393   501   507   427   447   383   355   318   403   413   385   391   349   419   382   393   366   400   372   364   440   344   347   391   375   377   418   391   372   448   368   342   374
   S4   626   476   277   234    75   382   350   401   439   476   527   453   492   438   382   385   442   432   419   457   379   462   393   432   390   435   431   407   466   398   353   458   404   410   472   437   410   470   422   356   391
   S3   403   396   264   251   223   306   304   301   352   373   417   386   391   359   305   334   397   350   329   374   330   349   327   340   328   361   323   329   344   318   322   333   332   325   349   346   337   345   363   350   369
   S2   609   570   358   356    99   439   428   463   511   537   610   531   541   519   438   388   456   445   463   457   408   458   447   478   385   457   434   393   516   466   388   464   469   421   463   492   420   482   467   385   391
   S1   605   577   353   377    98   439   425   474   496   531   539   536   540   519   447   384   469   446   462   454   411   464   441   486   390   454   445   397   501   473   393   454   471   429   460   506   418   480   465   379   395
   S0   659   615   434   426   171   462   479   543   551   596   594   595   599   598   522   413   519   529   522   477   495   502   480   563   449   517   503   448   551   537   477   478   537   493   543   569   497   535   503   444   451
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36    37    38    39    40
   S9   343   322   315   339   353   347   355   338   350   348   350   347   348   338   333   335   331   333   327   337   341   328   329   318   328   321   315   324   330   323   315   322   335   325   322   320   328   325   329   336   327
   S8   335   315   310   325   343   340   342   330   342   334   343   337   334   328   323   326   320   322   316   325   325   323   316   312   316   310   303   308   323   310   305   312   320   312   320   307   316   314   315   324   315
   S7   352   347   334   339   364   359   363   352   365   354   364   359   356   348   345   341   344   343   335   343   347   343   336   336   331   335   322   326   341   334   324   337   341   335   342   326   342   332   338   345   340
   S6   374   368   360   356   383   375   386   379   381   374   382   377   375   361   360   359   362   359   354   360   364   367   358   356   351   355   344   343   363   353   349   359   361   359   365   353   362   359   360   365   364
   S5   408   400   394   382   410   410   411   412   412   406   414   404   402   394   389   390   389   393   387   389   396   398   390   387   386   386   375   376   394   384   387   390   395   394   400   390   398   396   394   398   399
   S4   454   448   434   420   449   456   451   455   459   445   451   447   445   443   436   435   435   436   435   436   439   445   435   428   428   432   424   417   437   433   435   431   435   437   442   436   445   443   440   441   448
   S3   353   358   348   350   356   362   361   362   367   363   365   362   355   357   352   353   356   353   351   356   352   355   357   342   342   351   350   343   347   350   351   346   352   346   352   353   350   354   349   352   361
   S2   475   469   455   441   458   475   469   475   477   470   479   465   465   467   459   452   453   458   459   455   457   462   454   447   451   446   447   434   462   456   458   453   455   452   448   460   461   465   456   454   463
   S1   477   472   456   440   460   470   463   480   475   475   481   468   466   477   467   456   456   460   461   456   455   466   456   447   450   455   451   437   465   465   461   459   455   459   451   462   454   463   449   457   461
   S0   530   532   513   490   508   526   522   538   526   526   524   519   531   535   524   511   507   513   517   508   512   517   505   508   514   509   503   493   509   514   508   511   505   509   500   509   513   524   501   516   509

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;

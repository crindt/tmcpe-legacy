
$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S13/
	M1	Time Steps	/0*36/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S13	1.795000
		S12	0.410000
		S11	0.600000
		S10	0.495000
		S9	0.365000
		S8	0.240000
		S7	0.405000
		S6	0.405000
		S5	0.295000
		S4	0.240000
		S3	0.420000
		S2	0.375000
		S1	0.455000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
  S13   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S12   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S11   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
  S10   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S9   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S8   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S7   1.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0
   S6   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S5   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S4   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S3   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S2   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S1   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
  S13  67.7  68.0  69.5  68.9  69.0  67.9  67.3  72.2  70.5  70.6  70.1  68.6  69.1  68.9  68.3  67.8  69.1  68.8  69.1  69.4  70.0  69.1  68.2  69.6  70.5  68.1  68.8  67.9  68.4  68.0  68.4  69.3  68.9  68.9  68.8  68.7  68.4
  S12  66.8  67.5  68.3  67.7  67.6  67.2  67.5  68.4  69.2  68.4  68.0  67.5  68.3  67.8  67.8  68.4  69.4  69.3  70.3  70.1  70.7  71.0  69.4  70.0  71.8  69.3  69.4  68.4  69.2  69.7  70.2  70.7  71.3  71.1  70.4  70.7  69.7
  S11  72.3  71.8  71.1  72.0  71.7  72.1  72.6  74.4  73.8  72.3  71.0  71.3  71.6  71.6  70.9  70.5  70.7  71.4  71.7  71.3  70.4  71.8  70.7  71.2  71.2  71.0  70.1  70.6  69.2  70.0  69.9  69.6  68.7  70.7  69.4  70.3  69.2
  S10  67.8  68.3  68.0  68.6  67.9  68.8  69.0  71.9  70.4  69.0  68.6  68.9  69.8  68.8  68.1  67.1  66.7  66.0  65.5  67.2  66.7  68.5  67.6  67.2  67.5  68.0  68.3  68.2  67.3  68.4  68.3  67.6  67.1  68.4  67.4  68.9  68.2
   S9  68.9  68.6  69.4  70.0  69.0  68.8  69.8  72.3  71.9  70.3  69.9  68.6  69.0  68.4  69.3  69.8  68.3  69.0  69.5  69.9  69.1  69.8  69.0  69.3  68.7  68.7  68.3  68.9  68.5  69.3  69.3  68.6  69.1  69.5  68.1  69.8  69.6
   S8  62.5  62.7  62.5  62.9  62.1  63.2  64.5  66.2  65.6  63.6  62.9  62.0  61.7  63.0  63.2  62.6  62.2  62.6  63.0  62.7  62.7  64.4  64.2  63.9  62.1  61.1  60.9  63.4  62.7  62.8  62.0  62.7  62.4  62.9  62.5  63.2  63.2
   S7  63.8  62.2  63.3  62.6  62.7  62.2  63.1  66.0  65.1  63.8  63.6  62.8  63.6  63.9  64.1  64.5  63.7  63.6  64.4  63.9  63.5  64.0  63.8  64.7  62.0  62.4  62.4  63.5  62.4  63.3  63.2  62.6  61.7  62.5  63.0  64.7  64.1
   S6  69.5  69.1  69.3  70.0  70.3  70.0  70.9  73.5  71.7  71.2  70.8  70.1  69.9  70.2  71.1  71.6  70.8  70.7  70.3  69.2  69.7  70.7  70.4  71.6  70.4  69.5  69.4  69.4  69.0  71.0  70.2  69.7  70.0  70.8  69.2  69.9  69.1
   S5  64.0  61.7  63.1  62.9  62.6  62.6  64.8  63.7  63.9  63.9  64.5  64.9  65.4  66.9  68.5  69.6  66.6  64.1  62.3  64.0  64.3  65.2  66.3  67.2  64.5  64.1  63.9  63.8  65.0  67.4  65.3  65.8  67.7  64.0  61.3  65.5  65.8
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S3   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S2  62.8  61.7  62.5  62.1  62.1  62.5  63.0  62.4  62.4  62.8  62.9  63.4  63.4  64.3  65.3  66.4  65.4  62.9  63.4  63.4  62.4  62.1  62.7  61.9  63.8  63.6  63.0  62.2  60.8  62.6  63.2  62.6  63.4  63.5  62.0  60.8  61.5
   S1  71.6  70.9  71.3  71.5  71.2  72.4  71.5  73.9  73.0  71.2  71.5  70.9  71.2  71.5  70.3  71.4  71.3  71.0  72.8  73.1  73.1  73.4  74.1  72.7  74.0  73.7  72.9  73.4  71.6  73.5  73.5  72.2  74.2  73.4  73.1  71.6  72.2
   S0  77.5  77.2  76.4  76.8  77.1  77.7  77.8  79.3  78.4  78.4  78.4  77.6  77.8  77.6  77.1  77.8  77.8  78.1  78.4  79.0  79.2  79.4  79.9  79.6  78.0  77.8  79.3  78.6  77.9  78.4  77.5  76.8  78.1  78.0  78.4  77.9  78.5
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
  S13  66.5  66.5  66.7  66.6  66.7  66.3  66.3  67.2  66.9  66.6  66.4  66.4  66.3  66.4  66.6  66.5  66.6  66.6  66.5  67.0  66.7  66.7  66.4  66.4  66.6  66.5  66.7  66.8  66.9  66.9  66.8  67.1  66.6  66.7  66.7  66.7  66.7
  S12  68.4  68.3  68.3  68.3  68.5  68.1  68.2  68.9  68.6  68.2  68.3  68.1  67.9  67.9  68.0  68.1  67.9  68.0  68.1  68.4  68.2  68.2  68.0  68.1  68.3  68.4  68.3  68.5  68.7  68.5  68.5  69.1  68.8  68.7  68.7  68.4  68.3
  S11  65.9  66.2  66.1  66.2  66.2  66.1  65.9  66.7  66.1  66.2  65.8  65.6  65.5  65.4  65.3  65.2  65.0  65.0  64.8  65.3  64.7  64.8  64.8  64.8  64.7  64.8  65.0  64.7  64.7  64.8  64.4  64.7  64.6  64.3  64.2  64.2  64.2
  S10  68.5  68.6  68.7  68.8  69.1  68.9  68.7  69.9  69.4  69.1  68.7  68.6  68.4  68.3  68.2  68.1  68.1  68.0  67.9  68.7  68.1  67.9  67.9  68.0  67.7  67.8  67.9  67.8  68.0  68.1  67.7  68.1  68.1  67.8  67.4  67.4  67.3
   S9  69.1  69.1  69.1  69.3  69.3  69.4  69.4  70.1  69.6  69.3  69.4  68.9  68.7  68.9  69.2  69.2  69.0  69.2  69.0  70.0  69.5  69.1  68.9  68.9  68.6  68.6  68.8  68.7  68.8  68.8  68.8  69.0  68.7  68.8  68.5  68.5  68.7
   S8  66.0  66.0  66.2  66.3  66.5  66.6  66.7  67.4  67.0  66.8  67.0  66.8  66.3  66.4  66.7  66.6  66.6  66.9  66.7  67.3  67.0  66.7  66.4  66.7  66.4  66.4  66.8  67.0  67.0  67.3  67.1  67.5  67.3  67.5  67.1  67.2  67.3
   S7  66.4  66.5  66.7  66.8  67.0  67.1  67.2  67.8  67.2  67.0  66.9  66.5  66.5  66.6  66.9  66.8  66.7  66.8  66.9  67.5  67.2  67.0  66.6  66.9  66.6  66.7  66.8  66.7  66.5  66.6  66.7  67.4  67.0  67.4  66.9  67.0  66.9
   S6  65.8  65.7  65.8  65.9  66.0  65.9  65.9  66.9  66.5  66.0  65.9  65.7  65.6  65.5  65.7  65.5  65.4  65.5  65.5  65.6  65.4  65.2  65.0  65.2  65.0  64.9  64.9  65.0  64.9  65.0  65.0  65.7  65.1  65.1  64.7  64.6  64.6
   S5  55.6  55.6  55.7  55.8  56.0  56.0  56.0  57.3  56.9  56.1  56.4  56.1  55.8  55.6  55.6  56.0  56.0  55.9  55.6  56.6  56.2  55.6  55.4  55.3  55.2  55.6  55.4  55.4  55.7  55.6  55.8  56.5  56.0  55.8  55.6  55.7  55.2
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S3   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S2  62.9  62.9  62.6  62.6  62.4  62.4  62.3  63.0  62.5  62.2  61.9  62.1  61.6  61.8  62.1  62.0  62.0  61.8  61.3  61.8  61.9  61.8  61.7  61.5  61.7  61.8  61.9  61.9  61.7  61.8  62.1  62.6  62.1  62.0  61.8  62.0  62.0
   S1  71.8  71.4  71.2  71.2  70.9  71.1  71.4  72.3  71.4  71.2  71.0  70.8  70.1  70.4  70.4  70.5  70.2  70.0  69.7  69.7  69.9  69.9  70.0  69.9  70.0  70.2  69.8  70.2  69.8  69.8  70.0  70.6  69.8  69.8  69.2  69.5  69.2
   S0  70.6  70.3  69.9  70.0  69.7  69.7  70.0  70.4  69.8  69.5  69.3  69.2  69.0  68.8  68.9  68.8  68.4  68.6  68.7  68.7  68.6  68.3  68.1  67.8  68.0  67.9  67.4  67.0  67.2  67.5  67.7  68.0  67.4  66.9  66.6  66.5  66.5
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
  S13   128   125   114   170   154   167   150   149   178   163   180   194   179   189   198   227   201   181   205   175   206   199   210   185   272   209   205   223   245   210   209   250   204   188   268   238   231
  S12   136   119   120   177   145   168   156   152   162   178   187   174   195   183   187   230   217   180   189   201   200   184   232   186   204   220   216   205   240   233   216   227   234   189   244   251   234
  S11   184   182   194   250   228   216   217   242   220   229   244   232   249   265   260   282   311   267   266   263   275   274   301   274   272   274   301   271   310   319   289   296   299   275   320   330   313
  S10   178   188   198   245   227   221   222   228   220   225   245   240   250   261   269   276   301   276   268   248   287   275   288   279   298   266   291   285   314   307   306   297   284   292   318   320   319
   S9   160   197   184   229   223   210   186   225   204   184   207   225   213   219   252   219   288   264   224   242   208   252   219   202   286   256   258   290   244   264   259   279   249   270   301   293   267
   S8   145   190   168   213   215   194   174   212   178   173   183   221   185   188   236   210   253   231   212   221   172   236   201   179   258   236   234   263   227   231   233   261   230   232   294   272   233
   S7   160   177   173   215   210   198   174   215   178   178   180   216   179   189   239   214   247   237   210   229   179   230   214   169   248   244   231   260   238   233   229   267   239   230   282   280   227
   S6   202   239   224   259   274   270   221   269   256   239   247   268   262   264   308   295   345   319   295   308   255   323   312   264   294   306   354   339   347   343   323   359   323   343   407   400   332
   S5   144   158   161   170   174   186   161   164   176   165   178   187   184   192   191   196   235   207   207   229   187   223   211   183   180   207   245   229   239   235   218   225   234   247   272   277   225
   S4     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S3     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S2   234   242   242   247   253   257   240   251   255   235   265   261   270   267   284   277   322   436   410   398   411   414   447   432   384   413   454   460   466   487   449   474   464   466   492   566   508
   S1   353   371   390   418   400   450   414   406   382   418   420   448   429   451   498   488   484   459   435   417   433   443   458   457   434   436   463   492   498   513   479   509   478   498   522   598   538
   S0   350   352   375   402   414   432   422   396   397   395   421   451   426   427   476   482   495   433   429   406   430   449   453   423   486   406   458   483   489   521   451   540   496   497   529   568   534
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35    36
  S13   140   145   151   166   173   165   160   165   173   166   171   186   186   180   195   213   201   201   212   194   200   223   208   207   224   220   222   230   236   223   218   239   226   229   250   238   230
  S12   142   150   153   168   174   168   163   175   166   177   177   179   196   186   188   219   210   206   211   208   205   214   223   209   214   228   225   225   240   231   221   235   240   233   238   249   230
  S11   205   213   222   235   242   244   227   233   220   244   240   246   252   260   263   277   289   279   269   285   273   277   289   282   279   288   304   299   298   309   295   295   306   309   311   316   314
  S10   207   213   222   237   248   247   235   241   226   238   251   248   252   266   265   279   292   290   275   281   282   284   285   292   287   287   309   312   302   316   308   304   303   322   321   314   326
   S9   189   198   212   220   229   221   211   212   206   212   220   222   225   234   241   247   250   254   242   240   241   248   248   247   251   250   260   275   266   262   259   263   260   273   279   272   274
   S8   175   185   198   204   210   201   190   191   189   194   201   202   204   210   224   227   230   228   222   218   216   231   229   221   231   232   235   251   245   238   237   243   238   245   256   250   246
   S7   176   184   197   205   212   204   192   190   191   194   199   203   204   210   224   229   230   228   223   221   215   233   231   222   229   233   235   250   247   239   235   245   239   243   258   250   246
   S6   234   244   259   270   288   277   263   261   261   267   271   278   283   288   296   317   324   318   315   308   299   319   324   314   315   324   325   336   352   344   331   339   338   338   355   358   348
   S5   165   174   181   189   199   198   189   186   187   191   192   194   202   203   202   221   225   221   219   222   213   221   226   224   218   223   224   231   242   241   231   234   235   234   243   247   243
   S4     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S3     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0     0
   S2   325   334   352   376   395   390   362   369   366   372   384   390   395   394   411   431   438   443   431   429   424   436   447   454   448   446   461   472   477   480   469   465   483   492   501   497   494
   S1   338   348   362   395   410   407   371   385   384   390   399   408   407   412   430   450   461   464   446   445   441   452   464   475   467   462   482   492   500   503   495   490   508   520   531   521   520
   S0   333   341   357   386   403   398   371   377   376   380   394   403   409   407   420   446   453   455   435   456   436   453   460   468   466   464   474   495   500   500   488   494   514   527   529   533   519

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;


$ONUELLIST
OPTIONS ITERLIM = 500000000
*OPTIONS LIMROW = 1000  ** UNCOMMENT TO GET LISTING OF ALL CONSTRAINTS
OPTIONS WORK = 800000
OPTION MIP = CPLEX;

SETS
	J1	Sections	/S0*S9/
	M1	Time Steps	/0*35/

ALIAS ( J1, K1 )
ALIAS ( M1, R1 )

PARAMETERS

	L( J1 ) section length
	    /
		S9	0.790000
		S8	0.405000
		S7	0.275000
		S6	0.445000
		S5	0.425000
		S4	0.410000
		S3	0.600000
		S2	0.490000
		S1	0.455000

	    /
	    	TABLE P(J1,M1) Evidence
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S9   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   0.0
   S8   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S7   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0
   S6   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S5   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S4   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S3   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
   S2   0.0   0.0   0.0   0.0   1.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   0.0   0.0   0.0
   S1   1.0   1.0   1.0   1.0   0.0   0.0   0.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   1.0   1.0   1.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0
   S0   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5   0.5
	TABLE V( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S9  67.8  67.9  68.5  68.0  67.6  68.0  67.9  67.9  67.9  67.7  68.0  67.9  67.9  67.7  67.4  67.9  71.1  68.5  67.5  67.8  67.6  67.3  67.3  67.7  67.8  67.7  67.7  67.7  67.7  67.1  67.2  66.7  67.2  67.3  67.2  66.6
   S8  68.1  61.3  59.7  58.5  57.3  55.9  56.2  55.3  55.0  55.2  58.0  58.9  58.9  47.4  41.4  36.8  44.3  53.5  60.2  64.9  64.1  65.1  64.8  65.7  67.2  67.1  67.0  67.2  66.3  66.6  67.5  67.9  67.3  67.7  67.2  67.1
   S7  69.8  61.2  64.6  48.1  33.3  29.6  25.0  23.0  30.2  42.6  55.5  58.6  59.2  60.9  60.1  64.1  57.0  64.3  67.3  70.2  68.4  69.4  70.6  70.1  71.0  70.0  69.6  70.1  69.8  70.7  71.5  71.9  70.7  71.7  69.7  70.5
   S6  60.2  58.2  59.9  49.3  31.5  25.7  24.4  21.1  21.1  25.7  44.5  48.1  49.6  51.5  52.2  56.0  55.4  58.5  60.2  61.5  60.0  60.6  60.3  61.2  62.9  62.4  62.0  62.8  62.1  62.1  62.8  63.1  62.4  62.7  61.8  61.5
   S5  61.1  61.6  62.1  59.7  58.8  47.3  40.2  36.0  32.1  26.9  28.2  31.4  36.0  37.4  38.7  46.8  55.9  59.6  61.5  62.9  62.3  62.9  62.5  63.9  64.4  64.1  64.9  64.9  64.0  64.2  65.6  65.5  65.7  66.1  65.0  64.5
   S4  61.3  61.5  62.3  60.0  60.4  54.0  37.5  30.6  25.0  20.9  17.9  22.5  27.4  29.1  32.1  48.0  61.4  62.4  63.3  64.3  63.0  63.5  63.0  64.1  64.3  64.0  64.8  65.5  64.7  64.4  65.6  65.5  65.6  66.3  65.1  65.3
   S3  53.0  52.6  53.2  52.0  53.9  51.1  45.7  37.0  34.8  27.2  22.4  21.5  25.6  31.9  35.4  39.9  46.0  50.5  52.9  53.7  50.5  46.3  44.2  50.4  54.5  54.9  55.8  56.6  56.5  56.2  57.7  57.7  51.2  54.7  55.3  57.4
   S2  61.5  61.0  61.4  61.4  62.9  60.8  59.6  59.6  59.4  48.0  35.3  28.1  27.2  32.6  49.1  56.0  60.3  61.1  61.2  60.4  59.8  60.0  59.7  61.3  60.7  61.1  61.9  62.4  60.9  61.2  62.2  62.4  63.3  61.6  60.3  61.4
   S1  61.6  61.6  61.5  61.5  60.1  60.3  59.7  60.8  60.4  57.5  43.2  31.3  27.0  28.9  46.0  55.2  63.6  61.4  60.7  59.9  59.0  60.0  59.6  61.0  60.6  61.1  61.5  62.0  61.0  61.4  62.6  62.7  63.6  62.2  61.5  62.4
   S0  60.7  60.0  60.6  60.8  59.3  60.1  58.8  60.4  60.0  58.0  49.6  42.1  39.4  41.2  51.8  57.6  62.3  61.1  60.2  60.0  59.4  59.6  59.2  60.3  60.3  60.1  60.1  60.7  60.7  61.0  61.7  61.8  62.5  61.0  60.9  61.6
	TABLE AV( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S9  67.6  67.6  67.6  67.7  68.7  68.0  67.8  67.7  67.7  67.8  67.8  67.7  67.7  67.6  67.7  67.7  68.4  67.8  67.7  67.6  67.6  67.5  67.5  67.5  67.5  67.5  67.4  67.3  67.9  67.5  67.4  67.2  67.3  67.3  67.3  67.3
   S8  61.7  61.6  61.6  61.4  61.9  61.9  61.7  60.8  59.0  56.8  54.9  54.5  53.6  53.1  53.2  53.1  53.8  54.6  55.3  56.3  57.2  58.3  59.4  60.4  61.5  62.2  62.4  62.4  63.2  63.0  63.1  63.2  63.3  63.5  63.4  63.5
   S7  68.7  68.2  68.2  68.0  68.4  68.0  67.7  66.9  66.3  65.6  64.4  63.4  62.3  62.2  62.3  62.3  63.3  64.1  64.2  64.5  65.5  66.8  68.1  68.8  69.6  69.8  70.2  70.2  71.1  70.8  70.9  71.0  70.7  70.8  70.7  70.8
   S6  64.3  63.9  63.8  63.5  63.6  63.5  63.4  62.3  61.6  61.3  60.6  59.2  58.4  58.0  58.1  58.5  59.6  59.9  60.4  61.0  61.8  63.0  63.9  64.5  65.3  65.5  65.9  66.3  66.9  66.6  67.0  67.2  67.0  67.1  66.8  66.9
   S5  67.5  67.2  67.1  67.0  67.5  67.0  66.7  66.1  65.8  65.7  65.5  64.4  63.7  63.7  63.5  63.6  64.5  64.7  65.1  65.8  66.0  66.6  67.1  67.7  68.3  68.4  68.6  68.8  69.4  69.1  69.5  69.7  69.7  69.9  69.7  69.7
   S4  67.5  67.2  67.0  66.9  67.6  67.0  65.9  65.3  65.0  65.1  65.1  64.1  63.5  63.0  62.9  63.2  64.7  65.1  66.0  66.9  67.0  67.4  68.0  68.5  69.0  69.0  69.1  69.3  70.1  69.8  70.1  70.2  70.1  70.3  70.3  70.3
   S3  63.3  63.3  63.3  63.1  63.4  63.4  62.4  61.4  61.6  61.2  61.2  61.2  60.3  60.1  59.8  59.8  62.0  62.7  63.4  63.5  63.1  63.1  63.3  63.8  64.6  64.9  65.0  65.5  65.8  65.6  66.1  66.4  66.3  66.5  66.5  66.5
   S2  65.4  65.2  65.2  65.0  65.4  65.1  64.4  63.6  63.6  63.1  62.8  62.9  63.1  63.1  63.0  62.9  64.3  64.2  64.3  64.6  64.8  65.1  65.3  65.4  65.5  65.5  65.8  65.8  66.5  66.3  66.6  66.7  66.7  66.7  66.7  66.5
   S1  63.5  63.3  63.2  63.1  63.5  63.7  63.2  62.5  62.6  62.5  62.5  62.6  62.7  62.9  63.0  63.0  64.5  64.3  64.4  64.7  64.9  65.4  65.7  65.9  66.2  66.2  66.5  66.3  66.9  67.0  67.2  67.3  67.3  67.3  67.4  67.2
   S0  72.4  72.3  72.1  71.7  72.2  71.8  72.1  71.7  71.9  71.9  71.3  71.7  71.7  71.5  71.1  69.9  69.4  69.1  69.1  69.4  69.7  70.5  71.4  72.1  72.6  72.6  72.7  72.4  72.8  73.0  73.1  73.0  73.0  73.1  73.2  73.1
	TABLE F( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S9   481   433   483   402   394   446   447   442   429   477   500   497   497   497   491   486   387   478   416   379   409   434   393   363   381   360   371   339   344   326   288   343   256   256   256   274
   S8   486   430   463   414   414   430   442   420   419   476   475   501   486   499   496   478   361   457   407   371   422   407   406   357   362   350   371   339   330   321   304   314   276   231   258   259
   S7   614   579   618   564   524   570   555   544   509   586   566   651   646   641   643   620   503   544   542   488   525   553   497   470   454   465   494   464   402   420   398   384   375   328   341   353
   S6   541   524   541   514   454   504   500   461   408   523   497   578   594   581   587   532   439   444   460   428   464   460   430   394   411   416   424   390   363   362   342   341   308   280   298   278
   S5   616   602   609   637   598   626   609   622   550   479   550   650   669   654   664   583   515   499   534   510   524   520   499   473   463   512   457   432   442   409   385   385   347   333   331   318
   S4   611   601   633   645   600   668   608   635   564   502   531   626   673   651   662   574   566   517   535   514   535   506   489   479   467   515   460   433   453   405   388   386   340   361   326   323
   S3   482   464   490   505   528   532   523   509   489   441   407   459   493   522   522   444   437   424   435   436   328   356   374   411   387   430   380   365   378   331   327   336   273   320   276   289
   S2   571   555   547   560   618   610   593   663   589   588   514   498   536   597   582   500   468   467   458   472   506   448   446   447   402   474   406   394   397   347   353   340   276   326   283   289
   S1   579   555   569   573   583   609   605   675   608   621   567   515   541   569   592   495   507   489   469   455   520   466   450   446   398   494   399   388   413   337   360   353   266   345   275   290
   S0   562   512   549   514   540   544   565   636   572   582   491   466   484   501   578   525   499   481   455   468   493   468   434   461   424   503   417   411   432   356   372   381   303   380   315   323
	TABLE AF( J1, M1 )
          0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15    16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31    32    33    34    35
   S9   466   476   469   457   464   465   481   505   496   490   471   467   453   447   440   422   411   409   401   397   393   387   376   373   369   365   354   332   332   316   302   306   292   275   263   256
   S8   459   462   454   447   447   453   474   494   491   483   467   458   449   441   433   419   400   404   394   389   386   379   368   365   359   358   346   324   324   309   298   297   284   271   259   250
   S7   607   620   603   591   590   596   620   640   633   620   606   599   586   562   553   534   524   517   515   506   505   496   491   483   476   479   457   426   426   404   398   396   381   368   348   339
   S6   556   565   554   546   541   546   572   593   591   578   555   542   530   508   498   488   473   459   461   453   447   441   431   427   423   426   401   374   375   355   350   341   333   319   310   295
   S5   631   638   630   619   619   619   648   675   670   654   636   621   612   595   581   560   546   533   529   526   516   508   496   491   489   485   462   439   432   408   400   394   386   362   353   343
   S4   635   646   635   626   625   627   657   685   676   662   642   632   619   600   581   565   556   537   534   530   525   511   500   495   496   489   469   444   437   413   406   399   390   366   354   345
   S3   505   504   500   500   502   503   525   540   512   514   515   495   488   478   471   452   443   421   419   420   410   410   404   400   393   392   377   353   337   324   312   309   308   291   276   276
   S2   576   574   572   565   574   576   599   617   596   599   587   568   557   548   534   516   490   477   476   472   468   462   450   443   439   437   413   393   380   361   355   348   339   323   314   305
   S1   593   589   586   577   584   588   617   632   611   611   600   581   574   565   545   523   504   488   487   481   480   470   462   451   449   444   420   397   389   369   366   358   345   332   317   310
   S0   564   557   560   549   559   560   581   581   574   569   562   556   550   549   532   512   494   473   467   469   473   460   465   450   447   443   417   391   395   392   378   373   362   348   333   323

VARIABLES
	Z		objective
	D(J1,M1)	incident state
	Y		total incident delay
	A		average delay
	N		net delay

BINARY VARIABLE D

EQUATIONS
OBJECTIVE
EQ1
EQ2
 EQ3
 EQ4
 EQ5
 EQ6
 EQ7
TOTDELAY
AVGDELAY
NETDELAY
;

 OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, P( J1, M1 ) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, -0.1 * D( J1, M1 ) + P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
* OBJECTIVE ..	Z=E=SUM( J1, SUM( M1, 0.1*P(J1,M1) * D( J1, M1 ) + ( 1 - P( J1, M1 ) ) * ( 1 - D( J1, M1 ) ) ) ); 
EQ1(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), D( K1, M1 ) ) =l= CARD(J1) -  CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
EQ2(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) -  CARD(M1) * ( D( J1, M1 ) - D( J1, M1+1 ) );
 EQ3(J1,M1) ..	SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( J1, R1 ) ) =l= CARD(M1) +  CARD(M1) * ( D( J1, M1 ) - D( J1-1, M1 ) );
***             the sum over all cells upstream and later than the target cell must be zero if the target cell is a boundary cell in space(-) and time(+)
 EQ4(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and later than the target cell must be zero if the target cell is a boundary cell in space(+) and time(+)
 EQ5(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) > ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1+1 ) );
***             the sum over all cells downstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(+) and time(-)
 EQ6(J1,M1) ..	SUM( K1$(ORD( K1 ) > ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1+1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
***             the sum over all cells upstream and earlier than the target cell must be zero if the target cell is a boundary cell in space(-) and time(-)
 EQ7(J1,M1) ..	SUM( K1$(ORD( K1 ) < ORD( J1 ) ), SUM( R1$(ORD( R1 ) < ORD( M1 ) ), D( K1, R1 ) ) ) 
                  =l= 2*CARD(M1) * CARD(J1) -  CARD(M1) * CARD(J1) * ( D( J1, M1 ) - D( J1-1, M1 ) + D( J1, M1 ) - D( J1, M1-1 ) );
TOTDELAY ..	Y=E=SUM( J1, SUM( M1, L( J1 ) / V(J1,M1) * F( J1, M1 ) ) );
AVGDELAY ..	A=E=SUM( J1, SUM( M1, L( J1 ) / AV(J1,M1) * AF( J1, M1 ) ) );
NETDELAY ..	N=E=Y-A

MODEL BASE / ALL /;
SOLVE BASE USING MIP MINIMIZING Z;
DISPLAY D.l;
